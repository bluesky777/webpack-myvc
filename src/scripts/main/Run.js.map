{
  "version": 3,
  "file": "Run.js",
  "sourceRoot": "",
  "sources": [
    "Run.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "angular.module('myvcFrontApp')\n#- Run ejecuta código depués de haber configurado nuestro módulo con config()\n.run ['$rootScope', 'cfpLoadingBar', '$state', '$stateParams', '$cookies', 'Perfil', 'AuthService', 'AUTH_EVENTS', 'toastr', ($rootScope, cfpLoadingBar, $state, $stateParams, $cookies, Perfil, AuthService, AUTH_EVENTS, toastr) ->\n\n\n\t#- Asignamos la información de los estados actuales para poder manipularla en las vistas.\n\t$rootScope.$state = $state\n\t$rootScope.$stateParams = $stateParams;\n\t$rootScope.lastState = null; #- Para saber de qué viene cuando se redireccione automáticamente al login.\n\t$rootScope.lastStateParam = null;\n\t$rootScope.notaRapida = {enable: false, valorNota: 0}\n\n\t$rootScope.menucompacto = false\n\n\t#- Evento que se ejecuta cuando envío alguna petición al servidor que requiere autenticación y no está autenticado.\n\t$rootScope.$on 'event:auth-loginRequired', (r)->\n\t\tconsole.log 'Acceso no permitido, vamos a loguear', r\n\t\t$state.transitionTo 'login'\n\n\t$rootScope.ingresar = ()->\n\t\t#- Si lastState es null, quiere decir que hemos entrado directamente a login sin ser redireccionados.\n\t\tif $rootScope.lastState == null or $rootScope.lastState == 'login' or $rootScope.lastState == '/' or $rootScope.lastState == 'main'\n\t\t\t$state.transitionTo 'panel' #- Por lo tanto nos vamos a panel después de autenticarnos.\n\t\telse\n\t\t\t$state.transitionTo $rootScope.lastState, $rootScope.lastStateParam #- Si no es null ni login, Nos vamos al último estado.\n\t\t#console.log 'Funcion ingresar. lastState: ', $rootScope.lastState\n\n\t#- Evento ejecutado cuando nos logueamos despues del servidor haber pedido autenticación.\n\t$rootScope.$on 'event:auth-loginConfirmed', ()->\n\t\tconsole.log 'Logueado con éxito!'\n\t\t$rootScope.ingresar()\n\n\n\t#- Evento que se ejecuta cuando vamos a cambiar de estado.\n\t$rootScope.$on '$stateChangeStart', (event, next, toParams, fromState, fromParams)->\n\t\t#console.log 'Va a empezar a cambiar un estado: ', next, toParams\n\t\tif $rootScope.lastState == null or (next.name != 'logout' and next.name != 'login' and next.name != 'main' )\n\t\t\t$rootScope.lastState = next.name\n\t\t\t$rootScope.lastStateParam = toParams\n\n\n\t#- Evento cuando ya hemos cambiado de estado.\n\t$rootScope.$on '$stateChangeSuccess', (event, toState, toParams, fromState, fromParams)->\n\t\t#$rootScope.lastState = fromState.name if fromState.name != ''\n\t\t#-if $state.current.name == 'login' then cfpLoadingBar.complete() # No me funciona :(\n\t\t$rootScope.pageTitle = $state.current.name;\n\n\n\t#- Evento cuando falla la carga del estado, por un resolve rechazado o algo así.\n\t$rootScope.$on '$stateChangeError', (event, toState, toParams, fromState, fromParams)->\n\t\t#$rootScope.lastState = fromState.name if fromState.name != ''\n\t\t#-if $state.current.name == 'login' then cfpLoadingBar.complete() # No me funciona :(\n\t\tconsole.log 'Evento fallido: ', event\n\t\ttoastr.warning 'Lo sentimos, hubo un error o no puedes acceder a esta vista'\n\t\tif $rootScope.lastState != 'panel'\n\t\t\t$state.transitionTo 'panel'\n\n\n\n\t$rootScope.$on AUTH_EVENTS.loginSuccess, ()->\n\t\tusuario = Perfil.User()\n\t\tif usuario\n\t\t\tif usuario.votaciones\n\t\t\t\tif usuario.votaciones.length == 1\n\t\t\t\t\ttoastr.success 'Hay 1 votación en ejecución.'\n\t\t\t\telse\n\t\t\t\t\ttoastr.success 'Hay ' + usuario.votaciones.length + ' votaciones en ejecución.'\n\t\t\t\t$state.go 'panel.actividades.votaciones.votar'\n\t\t\telse\n\t\t\t\t$rootScope.ingresar()\n\n\n\n\t$rootScope.$on AUTH_EVENTS.loginFailed, (ev)->\n\t\t#toastr.error 'Datos incorrecto.', 'No se pudo loguear'\n\t\t#console.log 'Evento loginFailed: ', ev\n\n\n\n\t$rootScope.$on AUTH_EVENTS.notAuthenticated, (ev)->\n\t\ttoastr.warning 'No está autorizado.', 'Acceso exclusivo'\n\t\tconsole.log 'Evento notAuthenticated: ', ev\n\t\t$state.transitionTo 'login'\n\n\n\n\t$rootScope.$on AUTH_EVENTS.notAuthorized, (ev)->\n\t\ttoastr.warning 'No está autorizado para entrar a esta vista', 'Restringido'\n\t\t$state.go 'panel'\n\t\tconsole.log 'Evento notAuthorized: ', ev, $rootScope.lastState\n\n]\n"
  ]
}