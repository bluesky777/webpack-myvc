{
  "version": 3,
  "file": "CrearFaltaCtrl.js",
  "sourceRoot": "",
  "sources": [
    "CrearFaltaCtrl.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "angular.module('myvcFrontApp')\n\n.directive('faltasDeLasQueDerivaDir',['App', (App)->\n  restrict: 'E'\n  templateUrl: \"#{App.views}comportamiento/faltasDeLasQueDerivaDir.tpl.html\"\n])\n.directive('faltasDeLasQueDerivaNuevoDir',['App', (App)->\n  restrict: 'E'\n  templateUrl: \"#{App.views}comportamiento/faltasDeLasQueDerivaNuevoDir.tpl.html\"\n])\n\n.controller('CrearFaltaCtrl', ['$scope', '$uibModalInstance', 'alumno', 'per_num', 'periodos', 'config', 'ordinales', 'profesores', 'creando', '$http', 'toastr', 'App', 'AuthService', ($scope, $modalInstance, alumno, per_num, periodos, config, ordinales, profesores, creando, $http, toastr, App, AuthService)->\n  $scope.alumno \t\t    = alumno\n  $scope.datos          = {}\n  $scope.config         = config\n  $scope.periodos \t\t  = periodos\n  $scope.profesores \t  = profesores\n  $scope.ordinales \t    = ordinales\n  $scope.perfilPath \t  = App.images+'perfil/'\n  $scope.falta_new      = {}\n  $scope.eliminando \t  = false\n  $scope.hasRoleOrPerm  = AuthService.hasRoleOrPerm\n\n\n  for peri in $scope.periodos\n    peri.activo = false\n    if peri.numero == per_num\n      peri.activo \t\t\t\t\t\t= true\n      peri.creando \t\t\t\t\t\t= creando\n      $scope.datos.periodo \t\t= peri\n\n\n\n  $scope.toggleVerCrear = (periodo, estado)->\n    periodo.creando = estado\n\n\n  $scope.eliminarFalta = (periodo, falta)->\n    if $scope.eliminando\n      return\n\n    res = confirm('Â¿Seguro desea eliminar esta falta?')\n\n    if res\n      $scope.eliminando = true\n\n      $http.put('::disciplina/destroy', {proceso_id: falta.id, alumno_id: alumno.alumno_id}).then((r)->\n        toastr.success 'Falta eliminada.'\n        $scope.eliminando = false\n        $scope.reemplazarAlumno(r.data, falta.descripcion, true)\n      , (r2)->\n        toastr.error 'No se pudo eliminar.', 'Problema'\n        $scope.eliminando = false\n      )\n\n\n  $scope.editarFalta = (periodo, falta)->\n    if falta.fecha_hora_aprox\n      if falta.fecha_hora_aprox.replace\n        falta.fecha_hora_aprox = new Date(falta.fecha_hora_aprox.replace(/-/g, '\\/'))\n\n    $scope.falta_edit = falta\n\n    $scope.falta_edit.selected_ordinales = [];\n\n    for proce_oridinal in falta.proceso_ordinales\n      for ordinal_original in $scope.ordinales\n        if proce_oridinal.id == ordinal_original.id\n          $scope.falta_edit.selected_ordinales.push(ordinal_original)\n\n    periodo.editando  = true\n\n\n  $scope.cancelarEditarFalta = (periodo)->\n    periodo.editando  = false\n\n\n  $scope.seleccionandoOrdinal = ($item)->\n    $item.proceso_id = $scope.falta_edit.id\n\n    $http.post('::disciplina/asignar-ordinal', $item).then((r)->\n      toastr.success 'Ordinal asignado.'\n    , (r2)->\n      toastr.error 'No se pudo asignar.', 'Problema'\n    )\n\n  $scope.quitandoOrdinal = ($item)->\n    $item.proceso_id = $scope.falta_edit.id\n\n    $http.put('::disciplina/quitar-ordinal', $item).then((r)->\n      toastr.success 'Ordinal quitado.'\n    , (r2)->\n      toastr.error 'No se pudo quitar.', 'Problema'\n    )\n\n\n  $scope.reemplazarAlumno = (alumno, descripcion, eliminado)->\n    $scope.alumno = alumno\n\n    for original, index in $scope.alumnos\n      if original\n        if original.alumno_id == alumno.alumno_id\n          $scope.alumnos.splice(index, 1)\n\n    $scope.alumnos.push(alumno)\n\n\n    if descripcion\n      found = false\n      for descrip, indice in $scope.descripciones_typeahead\n        if descrip.descripcion==descripcion and eliminado!=true\n          found = indice\n\n      if found\n        if eliminado\n          $scope.descripciones_typeahead.splice(found, 1)\n        else\n          $scope.descripciones_typeahead.push({descripcion: descripcion})\n\n\n\n\n\n  $scope.crear_falta = (periodo)->\n\n    $scope.guardando_new  = true\n    situaciones_depend    = []\n\n    for situac in alumno.periodo1\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    for situac in alumno.periodo2\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    for situac in alumno.periodo3\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    for situac in alumno.periodo4\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    $scope.falta_new.dependencias \t= situaciones_depend\n    $scope.falta_new.year_id \t\t\t\t= periodo.year_id\n    $scope.falta_new.periodo_id \t\t= periodo.id\n    $scope.falta_new.alumno_id \t\t  = $scope.alumno.alumno_id\n\n\n    $http.post('::disciplina/store', $scope.falta_new).then((r)->\n      toastr.success 'Falta creada.'\n      $scope.guardando_new  = false\n      periodo.creando       = false\n      $scope.reemplazarAlumno(r.data, $scope.falta_new.descripcion)\n\n      if creando\n        $modalInstance.close(r.data)\n    , (r2)->\n      $scope.guardando_new  = false\n      toastr.error 'No se pudo crear.', 'Problema'\n    )\n\n\n\n\n  $scope.clickSituacionDerivante = (situac)->\n    console.log(situac, $scope.falta_edit)\n\n    if situac.seleccionado\n      situac.become_id = $scope.falta_edit.id\n    else\n      situac.become_id = null\n\n\n    $http.put('::disciplina/cambiar-situacion-derivante', situac).then((r)->\n      toastr.success 'Cambios guardados.'\n    , (r2)->\n      $scope.guardando_edit  = false\n      toastr.error 'No se pudo guardar.', 'Problema'\n    )\n\n\n\n\n\n  $scope.guardar_falta = (periodo)->\n\n    $scope.guardando_edit   = true\n    situaciones_depend      = []\n\n    for situac in alumno.periodo1\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    for situac in alumno.periodo2\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    for situac in alumno.periodo3\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    for situac in alumno.periodo4\n      if situac.seleccionado\n        situaciones_depend.push(situac)\n\n    $scope.falta_edit.alumno_id = $scope.alumno.alumno_id\n    $scope.falta_edit.dependencias = situaciones_depend\n\n    $http.put('::disciplina/update', $scope.falta_edit).then((r)->\n      toastr.success 'Cambios guardados.'\n      $scope.guardando_edit  \t= false\n      periodo.editando  \t\t\t= false\n      $scope.reemplazarAlumno(r.data, $scope.falta_edit.descripcion)\n    , (r2)->\n      $scope.guardando_edit  = false\n      toastr.error 'No se pudo guardar.', 'Problema'\n    )\n\n\n\n\n\n  $scope.ok = ()->\n    $modalInstance.close($scope.alumno)\n\n\n])\n\n"
  ]
}