{
  "version": 3,
  "file": "OrdinalesCtrl.js",
  "sourceRoot": "",
  "sources": [
    "OrdinalesCtrl.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "'use strict'\n\nangular.module('myvcFrontApp')\n\n.controller('OrdinalesCtrl', ['$scope', 'toastr', '$http', '$uibModal', '$state', '$filter', 'App', 'AuthService', 'Acentos', '$interval', '$anchorScroll', '$location', ($scope, toastr, $http, $modal, $state, $filter, App, AuthService, Acentos, $interval, $anchorScroll, $location)->\n\n\tAuthService.verificar_acceso()\n\n\t$scope.datos \t\t      \t= {}\n\t$scope.perfilPath \t  \t= App.images+'perfil/'\n\t$scope.views \t\t      \t= App.views\n\t$scope.nota_minima_aceptada = parseInt($scope.USER.nota_minima_aceptada)\n\t$scope.gridOptions      = {}\n\t$scope.creando          = false\n\t$scope.editando         = false\n\t$scope.guardando        = false\n\t$scope.configuracion \t\t= {\n\t\treinicia_por_periodo: 0\n\t}\n\n\t$scope.ordinal_new \t= {\n\t\t\tordinal: '',\n\t\t\tdescripcion: '',\n\t\t\tpagina: ''\n\t\t}\n\n\n\t$scope.configurar = ()->\n\t\t$location.hash('configurar-convivencia');\n\t\t$anchorScroll();\n\n\t$scope.selectYear = (year)->\n\t\t$scope.traerOrdinales(year.id, false)\n\n\n\t$scope.verCrear = ()->\n\t\t$scope.creando \t\t\t= true\n\t\t$scope.ordinal_new.year_id = $scope.datos.year.id\n\n\n\t$scope.cancelarCrear = ()->\n\t\t$scope.creando \t\t\t= false\n\t\t$scope.ordinal_new \t= {\n\t\t\tordinal: '',\n\t\t\tdescripcion: '',\n\t\t\tpagina: ''\n\t\t}\n\n\t$scope.cancelarEditar = ()->\n\t\t$scope.editando = false\n\n\t$scope.editar = (ordinal)->\n\t\t$scope.ordinal_edit = ordinal\n\t\t$scope.editando \t\t= true\n\n\t$scope.crear = (ordinal)->\n\t\tif !$scope.datos.year\n\t\t\ttoastr.warning('Elija el año')\n\t\t\treturn\n\n\t\t$scope.guardando = true\n\n\t\tordinal.year_id = $scope.datos.year.id\n\n\t\t$http.post('::ordinales/store', ordinal).then((r)->\n\t\t\tconsole.log(r.data, $scope.gridOptions)\n\t\t\t$scope.gridOptions.data.push(r.data)\n\t\t\ttoastr.success('Creado con éxito.')\n\t\t\t$scope.guardando = false\n\t\t, ()->\n\t\t\ttoastr.error 'No se puedo crear'\n\t\t\t$scope.guardando = false\n\t\t)\n\n\n\n\n\t$scope.eliminar = (ordinal)->\n\t\tres = confirm(\"¿Seguro que desea eliminar?\")\n\t\tif res\n\n\t\t\t$http.put('::ordinales/destroy', {ordinal_id: ordinal.id}).then((r)->\n\t\t\t\t$scope.gridOptions.data.push(r.data)\n\t\t\t\ttoastr.success('Eliminado con éxito.')\n\n\t\t\t\tfor ordin, indice in $scope.gridOptions.data\n\t\t\t\t\tif ordin.id == ordinal.id\n\t\t\t\t\t\t$scope.gridOptions.data.splice(indice, 1)\n\t\t\t\t\t\treturn\n\n\t\t\t, ()->\n\t\t\t\ttoastr.error 'No se puedo crear'\n\t\t\t\t$scope.guardando = false\n\t\t\t)\n\n\n\t$scope.guardar_cambios = (ordinal)->\n\t\tif !$scope.datos.year\n\t\t\ttoastr.warning('Elija el año')\n\t\t\treturn\n\n\t\tordinal.year_id = $scope.datos.year.id\n\n\t\t$http.put('::ordinales/update', ordinal).then((r)->\n\t\t\ttoastr.success('Editado con éxito.')\n\t\t\t$scope.editando = false\n\t\t, ()->\n\t\t\ttoastr.error 'No se puedo crear'\n\t\t)\n\n\n\tbtGrid1 = '<a uib-tooltip=\"Editar\" tooltip-placement=\"left\" class=\"btn btn-default btn-xs shiny icon-only info\" ng-click=\"grid.appScope.editar(row.entity)\"><i class=\"fa fa-edit \"></i></a>'\n\tbtGrid2 = '<a uib-tooltip=\"X Eliminar\" tooltip-placement=\"right\" class=\"btn btn-default btn-xs shiny icon-only danger\" ng-click=\"grid.appScope.eliminar(row.entity)\"><i class=\"fa fa-trash \"></i></a>'\n\tbt1 \t= '<span style=\"padding-left: 2px; padding-top: 4px;\" class=\"btn-group\">' + btGrid1 + btGrid2 + '</span>'\n\n\t$scope.gridOptions =\n\t\tshowGridFooter: true,\n\t\tshowColumnFooter: true,\n\t\tshowFooter: true,\n\t\tenableSorting: true,\n\t\tenableFiltering: true,\n\t\tenableGridMenu: true,\n\t\tenebleGridColumnMenu: false,\n\t\tenableCellEditOnFocus: true,\n\n\t\tcolumnDefs: [\n\t\t\t{ field: 'no', cellTemplate: '<div class=\"ui-grid-cell-contents\">{{grid.renderContainers.body.visibleRowCache.indexOf(row) + 1}}</div>', width: 40, enableCellEdit: false }\n\t\t\t{ name: 'edicion', displayName:'Edit', width: 54, enableSorting: false, enableFiltering: false, cellTemplate: bt1, enableCellEdit: false, enableColumnMenu: true}\n\t\t\t{ field: 'tipo', minWidth: 80, filter: { condition: Acentos.buscarEnGrid } }\n\t\t\t{ field: 'ordinal', minWidth: 70 }\n\t\t\t{ field: 'descripcion', displayName: 'Descripción', minWidth: 210, filter: { condition: Acentos.buscarEnGrid } }\n\t\t\t{ field: 'pagina', displayName: 'Página', minWidth: 70 }\n\t\t],\n\t\tmultiSelect: false,\n\n\t\tonRegisterApi: ( gridApi ) ->\n\t\t\t$scope.gridApi = gridApi\n\t\t\tgridApi.edit.on.afterCellEdit($scope, (rowEntity, colDef, newValue, oldValue)->\n\n\t\t\t\tif newValue != oldValue\n\n\n\t\t\t\t\t$http.put('::ordinales/guardar-valor', {ordinal_id: rowEntity.id, propiedad: colDef.field, valor: newValue } ).then((r)->\n\t\t\t\t\t\ttoastr.success 'Ordinal actualizado con éxito'\n\t\t\t\t\t, (r2)->\n\t\t\t\t\t\trowEntity[colDef.field] = oldValue\n\t\t\t\t\t\ttoastr.error 'Cambio no guardado', 'Error'\n\t\t\t\t\t)\n\n\t\t\t)\n\n\n\t$scope.traerOrdinales = (year_id, con_datos)->\n\t\t$http.put('::ordinales/ordinales', {year_id: year_id, con_datos: con_datos}).then((r)->\n\t\t\tr = r.data\n\n\t\t\tif $scope.configuracion\n\t\t\t\t$scope.config               = r.configuracion\n\t\t\t\t$scope.tipos                = r.tipos\n\n\t\t\t$scope.gridOptions.data       = r.ordinales\n\n\t\t, (r2)->\n\t\t\ttoastr.error 'No se pudo traer los datos.'\n\t\t)\n\n\n\n\t$scope.guardarValorConfig = (config, propiedad, valor)->\n\n\t\t$http.put('::ordinales/guardar-valor-config', {config_id: config.id, propiedad: propiedad, valor: valor } ).then((r)->\n\t\t\ttoastr.success 'Campo actualizado'\n\t\t, (r2)->\n\t\t\ttoastr.error 'Cambio no guardado', 'Error'\n\t\t)\n\n\n\n\tif $scope.$parent.years\n\t\tfor anio in $scope.$parent.years\n\t\t\tif anio.id == $scope.USER.year_id\n\t\t\t\t$scope.datos.year = anio\n\t\t$scope.traerOrdinales()\n\telse\n\t\t$scope.Timer = $interval(()->\n\n\t\t\tif $scope.$parent.years\n\t\t\t\tif angular.isDefined($scope.Timer)\n\t\t\t\t\t$interval.cancel($scope.Timer)\n\n\t\t\t\tfor anio in $scope.$parent.years\n\t\t\t\t\tif anio.id == $scope.USER.year_id\n\t\t\t\t\t\t$scope.datos.year = anio\n\n\t\t\t\t$scope.traerOrdinales()\n\t\t, 1000)\n\n\n\n\n\n\n\n])\n\n\n"
  ]
}