{
  "version": 3,
  "file": "CambiarCiudadModalCtrl.js",
  "sourceRoot": "",
  "sources": [
    "CambiarCiudadModalCtrl.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "angular.module(\"myvcFrontApp\")\n\n.controller('CambiarCiudadModalCtrl', ['$scope', '$uibModalInstance', 'persona', 'paises', 'tipo_ciudad', 'tipo_persona', '$http', 'toastr', '$filter', ($scope, $modalInstance, persona, paises, tipo_ciudad, tipo_persona, $http, toastr, $filter)->\n\t$scope.persona \t\t\t\t= persona\n\t$scope.paises \t\t\t\t= paises\n\t$scope.tipo_ciudad \t\t\t= tipo_ciudad\n\t$scope.modificarCiudades \t= false\n\t$scope.datos \t\t\t\t= {}\n\n\n\t$scope.creando_ciudad \t\t= false\n\t$scope.creando_departamento = false\n\t$scope.creando_pais \t\t= false\n\n\t$scope.ciudad_new \t\t\t= ''\n\t$scope.departamento_new \t= ''\n\t$scope.pais_new \t\t\t= ''\n\t$scope.modificando_depart \t= false\n\n\t\n\n\t$scope.crearCiudad = ()->\n\t\t$scope.creando_ciudad = true\n\t\t$scope.$broadcast('paisSeleccionadoEvent2');\n\n\t$scope.crearDepartamento = ()->\n\t\t$scope.creandodepartamento = true\n\n\t$scope.crearPais = ()->\n\t\t$scope.creandopais = true\n\n\t$scope.guardarCiudad = (ciudad_new, departamento_new)->\n\n\t\tif !$scope.datos.pais\n\t\t\ttoastr.warning 'Debes seleccionar un pais.'\n\t\t\treturn\n\t\tif !$scope.datos.departamento and departamento_new==''\n\t\t\ttoastr.warning 'Debe seleccionar departamento o escribir uno nuevo.'\n\t\t\treturn\n\t\tif ciudad_new==''\n\t\t\ttoastr.warning 'Debe escribir la nueva ciudad.'\n\t\t\treturn\n\n\t\tif $scope.datos.departamento\n\t\t\tdepart_guardar \t= departamento.departamento\n\t\telse\n\t\t\tdepart_guardar \t= departamento_new\n\n\t\t$http.post('::ciudades/guardar-ciudad', {ciudad: ciudad_new, departamento: depart_guardar, pais_id: $scope.datos.pais.id } ).then( (r)->\n\t\t\ttoastr.success 'Creado correctamente: ' + r.data.ciudad\n\t\t\tif $scope.datos.departamento then $scope.ciudades.push r.data\n\t\t\t$scope.creandociudad \t= false\n\t\t\t$scope.ciudad_new \t\t= '' # No sé por qué no funciona!\n\t\t\t$scope.departamento_new = ''\n\n\t\t\t$scope.guardar = true\n\n\t\t\t$http.get('::paises').then((r)->\n\t\t\t\t$scope.paises = r.data\n\t\t\t\t$scope.paisSelect($filter('filter')($scope.paises, { id: 1 })[0])\n\t\t\t, (r2)->\n\t\t\t\ttoastr.error 'No se pudo traer las ciudades.'\n\t\t\t)\n\t\t, (r2)->\n\t\t\ttoastr.error 'No se pudo crear', 'Error'\n\t\t)\n\n\t$scope.guardarPais = ()->\n\n\t\t$http.post('::paises/guardar', $scope.pais_new ).then( (r)->\n\t\t\ttoastr.success 'Creado correctamente: ' + r.data.paisnuevo\n\t\t\t$scope.paises.push r.data\n\t\t\t$scope.paisSelect($scope.ciudad_new.pais)\n\t\t\t\t\n\t\t, (r2)->\n\t\t\ttoastr.error 'No se pudo crear', 'Error'\n\t\t)\n\n\t$scope.escribeEnDepartamentoNew = ()->\n\t\t$scope.datos.departamento = undefined\n\n\t$scope.actualizarCiudad = (ciudad)->\n\t\t$http.put('::ciudades/actualizar-ciudad', ciudad).then( (r)->\n\t\t\ttoastr.success 'Actualizado: ' + ciudad.ciudad\n\t\t\tciudad.editandoCiudad = false\n\t\t, (r2)->\n\t\t\ttoastr.error 'No se pudo actualizar', 'Error'\n\t\t)\n\n\t$scope.actualizarDepartamento = (ciudad)->\n\t\t$http.put('::ciudades/actualizar-departamento', ciudad).then( (r)->\n\t\t\ttoastr.success 'Actualizado: ' + ciudad.departamento\n\t\t\tciudad.editandoDepart = false\n\t\t\tpais = $scope.ciudad_new.pais\n\n\t\t\tfor ciud in $scope.ciudades\n\t\t\t\tciud.departamento = ciudad.departamento\n\n\t\t\t$scope.modificando_depart = true\n\n\t\t, (r2)->\n\t\t\ttoastr.error 'No se pudo actualizar', 'Error'\n\t\t)\n\t$scope.actualizarPais = (pais)->\n\t\t$http.put('::paises/actualizar', pais).then( (r)->\n\t\t\ttoastr.success 'Actualizado: ' + pais.pais\n\t\t\tpais.editandoPais = false\n\t\t\tpais.editandoAbrev = false\n\t\t, (r2)->\n\t\t\ttoastr.error 'No se pudo actualizar', 'Error'\n\t\t)\n\n\n\n\n\n\t$scope.paisSelect = ($item, numero)->\n\t\t$http.put(\"::ciudades/departamentos-by-id\", { pais_id: $item.id }).then((r)->\n\t\t\t$scope.departamentos = r.data.departamentos\n\n\t\t\tif typeof $scope.datos.pais is 'undefined'\n\t\t\t\t$scope.datos.pais = $item\n\t\t\t$scope.$broadcast('paisSeleccionadoEvent' + numero);\n\t\t)\n\n\t# Que inicialmente aparezca la primera opción, Colombia.\n\t$scope.paisSelect($filter('filter')($scope.paises, { id: 1 })[0], 1)\n\n\n\t$scope.departamentoSelect = ($item, numero)->\n\t\tif $item\n\t\t\t$scope.departamento_new = ''\n\t\t\t$http.get(\"::ciudades/por-departamento/\"+$item.departamento).then((r)->\n\t\t\t\t$scope.ciudades = r.data\n\n\t\t\t\tif typeof $scope.datos.departamento is 'undefined'\n\t\t\t\t\t$scope.datos.departamento = $item\n\t\t\t\t$scope.$broadcast('departamentoSeleccionadoEvent' + numero);\n\t\t\t)\n\t\t\n\n\n\t$scope.eliminarCiudad = (ciudad)->\n\n\t\t$http.delete('::ciudades/destroy/'+ciudad.id).then((r)->\n\t\t\ttoastr.success 'Ciudad enviada a la papelera.', 'Eliminado'\n\t\t\t$scope.ciudades = $filter('filter')($scope.ciudades, {id: '!'+ciudad.id})\n\t\t, (r2)->\n\t\t\ttoastr.warning 'No se pudo enviar a la papelera.', 'Problema'\n\t\t)\n\n\t$scope.ok = (ciudad)->\n\t\tif $scope.seleccionandoCiudad\n\t\t\treturn\n\t\t$scope.seleccionandoCiudad = true\n\n\t\tciudad_selec = $scope.datos.ciudad\n\t\tif ciudad\n\t\t\tciudad_selec = ciudad\n\n\t\tdatos = { propiedad: tipo_ciudad, valor: ciudad_selec.id }\n\n\t\tif tipo_persona == 'acudiente'\n\t\t\tdatos.acudiente_id \t= persona.id\n\t\t\tdatos.parentesco_id = persona.parentesco_id\n\t\t\tdatos.user_acud_id \t= persona.user_id\n\t\telse\n\t\t\tdatos.alumno_id = persona.alumno_id\n\n\t\t$http.put('::' + tipo_persona + 's/guardar-valor', datos ).then((r)->\n\t\t\ttoastr.success 'Seleccionado.'\n\t\t\tpersona[tipo_ciudad + '_nombre'] \t= ciudad_selec.ciudad\n\t\t\tpersona[tipo_ciudad] \t\t\t\t= ciudad_selec.id\n\t\t\t$modalInstance.close(persona)\n\t\t, (r2)->\n\t\t\ttoastr.warning 'No se pudo seleccionar.', 'Problema'\n\t\t)\n\t\t\n\n\t$scope.cancel = ()->\n\t\t$modalInstance.dismiss('cancel')\n\n])\n"
  ]
}