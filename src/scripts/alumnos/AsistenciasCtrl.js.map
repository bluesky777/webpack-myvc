{
  "version": 3,
  "file": "AsistenciasCtrl.js",
  "sourceRoot": "",
  "sources": [
    "AsistenciasCtrl.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "'use strict'\n\nangular.module('myvcFrontApp')\n.controller('AsistenciasCtrl', ['$scope', 'toastr', '$http', '$uibModal', '$state', '$rootScope', '$filter', 'App', 'AuthService', '$timeout', 'EscalasValorativasServ', '$stateParams', 'NotasServ', ($scope, toastr, $http, $modal, $state, $rootScope, $filter, App, AuthService, $timeout, EscalasValorativasServ, $stateParams, NotasServ) ->\n\n\tAuthService.verificar_acceso()\n\n\t$scope.asignatura \t  = {}\n\t$scope.grupo_id       = $state.params.grupo_id\n\t$scope.datos \t\t      = {}\n\t$scope.perfilPath \t  = App.images+'perfil/'\n\t$scope.views \t\t      = App.views\n\t$scope.nota_minima_aceptada = parseInt($scope.USER.nota_minima_aceptada)\n\t$scope.ausencia_edit \t= {} # Para editar en el popover\n\t$scope.tardanza_edit \t= {}\n\t$scope.alumno_aus_tard_edit \t= {}\n\t$scope.opts_picker \t\t= { minDate: new Date('1/1/2017'), showWeeks: false, startingDay: 0 }\n\t$scope.hasRoleOrPerm  = AuthService.hasRoleOrPerm\n\n\t$http.put('::asistencias/detailed', {con_grupos: true}).then((r)->\n\t\t$scope.alumnos      = r.data.alumnos\n\t\t$scope.grupos \t\t\t= r.data.grupos\n\n\t\tmatr_grupo = 0\n\n\t\tif localStorage.matr_grupo\n\t\t\tmatr_grupo = parseInt(localStorage.matr_grupo)\n\n\t\tfor grupo in $scope.grupos\n\t\t\tif parseInt(grupo.id) == parseInt(matr_grupo)\n\t\t\t\t$scope.grupo = grupo\n\t\t\t\t$scope.traerAsistencias($scope.grupo)\n\n\t, (r2)->\n\t\ttoastr.error 'No se pudo traer las notas con asignaturas.'\n\t)\n\n\n\n\t$scope.traerAsistencias = (grupo)->\n\t\tlocalStorage.matr_grupo = grupo.id\n\n\t\t$state.go('.', {grupo_id: grupo.id}, {notify: false});\n\n\t\t$http.put('::asistencias/detailed', {grupo_id: grupo.id, con_grupos: false}).then((r)->\n\t\t\t$scope.alumnos      = r.data.alumnos\n\n\t\t\tfor alumno in $scope.alumnos\n\t\t\t\tfor ausencia in alumno.ausencias\n\t\t\t\t\tausencia.backup \t\t= ausencia.fecha_hora\n\t\t\t\t\tif ausencia.fecha_hora\n\t\t\t\t\t\tif ausencia.fecha_hora.replace\n\t\t\t\t\t\t\tausencia.fecha_hora \t= new Date(ausencia.fecha_hora.replace(/-/g, '\\/'))\n\t\t\t\t\telse\n\t\t\t\t\t\tausencia.fecha_hora \t= new Date()\n\n\t\t\t\tfor tarda in alumno.tardanzas\n\t\t\t\t\ttarda.backup \t\t= tarda.fecha_hora\n\t\t\t\t\tif tarda.fecha_hora\n\t\t\t\t\t\tif tarda.fecha_hora.replace\n\t\t\t\t\t\t\ttarda.fecha_hora \t= new Date(tarda.fecha_hora.replace(/-/g, '\\/'))\n\t\t\t\t\telse\n\t\t\t\t\t\ttarda.fecha_hora \t= new Date()\n\n\t\t, (r2)->\n\t\t\ttoastr.error 'No se pudo traer las asistencias.'\n\t\t)\n\n\t\tfor grupo_t in $scope.grupos\n\t\t\tgrupo_t.active = false\n\n\t\tgrupo.active      = true\n\t\t$scope.grupo_id   = grupo.id\n\t\t$scope.grupo      = grupo\n\n\n\n\t$scope.seleccionarFila = (alumno)->\n\t\tfor alum in $scope.alumnos\n\t\t\talum.seleccionado = false\n\t\talumno.seleccionado = true\n\n\n\n\n\n\n\t$scope.cambiaAusencia = (alumno)->\n\n\t\t# Si incrementó el número\n\t\tif alumno.ausencias_count > alumno.ausencias.length\n\t\t\tpedidas = alumno.ausencias_count - alumno.ausencias.length\n\n\t\t\tfor pedida in [0..pedidas-1]\n\t\t\t\tdatos =\n\t\t\t\t\talumno_id: \t\t\talumno.alumno_id\n\t\t\t\t\tentrada:        1\n\t\t\t\t\ttipo: \t\t\t\t\t'ausencia'\n\t\t\t\t# fecha_hora = new Date(numYearActual, parseInt($scope.dato.mes), dia)\n\n\t\t\t\t$http.post('::ausencias/store', datos).then((r)->\n\t\t\t\t\tr \t\t= r.data\n\t\t\t\t\t#r.fecha_hora = new Date(r.fecha_hora)\n\t\t\t\t\talumno.ausencias.push r\n\t\t\t\t, (r2)->\n\t\t\t\t\ttoastr.warning 'No se pudo agregar ausencia.', 'Problema'\n\t\t\t\t)\n\n\t\t# Si bajó el número\n\t\telse if alumno.ausencias_count < alumno.ausencias.length\n\t\t\tpedidas = alumno.ausencias.length - alumno.ausencias_count\n\n\t\t\tfor pedida in [0..pedidas-1]\n\t\t\t\tausencia_id = alumno.ausencias[alumno.ausencias.length - pedida - 1].id\n\n\t\t\t\t$http.delete('::ausencias/destroy/' + ausencia_id).then((r)->\n\t\t\t\t\tr \t\t= r.data\n\t\t\t\t\t#r.fecha_hora = new Date(r.fecha_hora)\n\t\t\t\t\talumno.ausencias = $filter('filter')(alumno.ausencias, { id: '!'+r.id })\n\t\t\t\t, (r2)->\n\t\t\t\t\ttoastr.warning 'No se pudo quitar ausencia.', 'Problema'\n\t\t\t\t)\n\n\n\n\n\t$scope.cambiaTardanza = (alumno)->\n\n\t\tif alumno.tardanzas_count > alumno.tardanzas.length\n\t\t\tpedidas = alumno.tardanzas_count - alumno.tardanzas.length\n\n\t\t\tfor pedida in [0..pedidas-1]\n\t\t\t\tdatos =\n\t\t\t\t\talumno_id: \t\t\talumno.alumno_id\n\t\t\t\t\tentrada:        1\n\t\t\t\t\ttipo: \t\t\t\t\t'tardanza'\n\t\t\t\t# fecha_hora = new Date(numYearActual, parseInt($scope.dato.mes), dia)\n\n\t\t\t\t$http.post('::ausencias/store', datos).then((r)->\n\t\t\t\t\tr \t\t= r.data\n\t\t\t\t\t#r.fecha_hora = new Date(r.fecha_hora)\n\t\t\t\t\talumno.tardanzas.push r\n\t\t\t\t, (r2)->\n\t\t\t\t\ttoastr.warning 'No se pudo agregar tardanza.', 'Problema'\n\t\t\t\t)\n\n\t\t# Si bajó el número\n\t\telse if alumno.tardanzas_count < alumno.tardanzas.length\n\t\t\tpedidas = alumno.tardanzas.length - alumno.tardanzas_count\n\n\t\t\tfor pedida in [0..pedidas-1]\n\t\t\t\ttardanza_id = alumno.tardanzas[alumno.tardanzas.length - pedida - 1].id\n\n\t\t\t\t$http.delete('::ausencias/destroy/' + tardanza_id).then((r)->\n\t\t\t\t\tr \t\t= r.data\n\t\t\t\t\t#r.fecha_hora = new Date(r.fecha_hora)\n\t\t\t\t\talumno.tardanzas = $filter('filter')(alumno.tardanzas, { id: '!'+r.id })\n\t\t\t\t, (r2)->\n\t\t\t\t\ttoastr.warning 'No se pudo quitar tardanza.', 'Problema'\n\t\t\t\t)\n\n\n\n\t$scope.clickAusenciaObject = (ausencia, alumno)->\n\t\tausencia.backup \t\t= ausencia.fecha_hora\n\t\tif ausencia.fecha_hora\n\t\t\tif ausencia.fecha_hora.replace\n\t\t\t\tausencia.fecha_hora \t= new Date(ausencia.fecha_hora.replace(/-/g, '\\/'))\n\t\telse\n\t\t\tausencia.fecha_hora \t= new Date()\n\t\t$scope.ausencia_edit \t  = ausencia\n\t\t$scope.alumno_aus_tard_edit \t= alumno\n\t\tausencia.isOpen = !ausencia.isOpen\n\n\n\t$scope.clickTardanzaObject = (tardanza, alumno)->\n\t\ttardanza.backup \t\t= tardanza.fecha_hora\n\t\tif tardanza.fecha_hora\n\t\t\tif tardanza.fecha_hora.replace\n\t\t\t\ttardanza.fecha_hora \t= new Date(tardanza.fecha_hora.replace(/-/g, '\\/'))\n\t\telse\n\t\t\ttardanza.fecha_hora \t= new Date()\n\t\t$scope.tardanza_edit \t= tardanza\n\t\t$scope.alumno_aus_tard_edit \t= alumno\n\t\ttardanza.isOpen = !tardanza.isOpen\n\n\n\n\t$scope.guardarCambioAusencia = (ausencia)->\n\t\tdatos =\n\t\t\tausencia_id: ausencia.id\n\t\t\tfecha_hora: $filter('date')(ausencia.fecha_hora, 'yyyy-MM-dd HH:mm:ss')\n\n\t\t$http.put('::ausencias/guardar-cambios-ausencia', datos).then((r)->\n\t\t\tr \t\t= r.data\n\t\t\t#r.fecha_hora = new Date(r.fecha_hora)\n\t\t\t#alumno.tardanzas.push r\n\t\t\t$scope.ausencia_edit.isOpen = false\n\t\t\t$scope.tardanza_edit.isOpen = false\n\t\t, (r2)->\n\t\t\ttoastr.warning 'No se pudo agregar tardanza.', 'Problema'\n\t\t)\n\n\n\t$scope.cancelarCambioAusencia = (ausencia_edit)->\n\t\tausencia_edit.isOpen = false\n\t$scope.cancelarCambioTardanza = (tardanza_edit)->\n\t\ttardanza_edit.isOpen = false\n\n\t$scope.eliminarAusencia = (ausencia, alumno_aus_tard_edit)->\n\t\t$http.delete('::ausencias/destroy/' + ausencia.id).then((r)->\n\t\t\tr \t\t= r.data\n\t\t\talumno_aus_tard_edit.ausencias = $filter('filter')(alumno_aus_tard_edit.ausencias, { id: '!'+r.id })\n\t\t\tausencia.isOpen = false\n\t\t, (r2)->\n\t\t\ttoastr.warning 'No se pudo quitar ausencia.', 'Problema'\n\t\t)\n\n\t$scope.eliminarTardanza = (tardanza, alumno_aus_tard_edit)->\n\t\t$http.delete('::ausencias/destroy/' + tardanza.id).then((r)->\n\t\t\tr \t\t= r.data\n\t\t\talumno_aus_tard_edit.tardanzas = $filter('filter')(alumno_aus_tard_edit.tardanzas, { id: '!'+r.id })\n\t\t\ttardanza.isOpen = false\n\t\t, (r2)->\n\t\t\ttoastr.warning 'No se pudo quitar tardanza.', 'Problema'\n\t\t)\n\n\n\n\n\n\n\n\t$scope.showFrases = (alumno)->\n\n\t\tmodalInstance = $modal.open({\n\t\t\ttemplateUrl: '==notas/showFrases.tpl.html'\n\t\t\tcontroller: 'ShowFrasesCtrl'\n\t\t\tsize: 'lg'\n\t\t\tresolve:\n\t\t\t\talumno: ()->\n\t\t\t\t\talumno\n\t\t\t\tfrases: ()->\n\t\t\t\t\t$http.get('::frases')\n\t\t\t\tasignatura: ()->\n\t\t\t\t\t$scope.asignatura\n\t\t\t\tUSER: ()->\n\t\t\t\t\t$scope.USER\n\t\t})\n\t\tmodalInstance.result.then( (datos)->\n\t\t\talumno.frases = datos.frases_asignatura\n\t\t(res)->\n\t\t\tconsole.log res\n\t\t)\n\n\n\treturn\n])\n\n\n\n\n\n"
  ]
}