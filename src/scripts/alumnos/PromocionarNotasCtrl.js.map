{
  "version": 3,
  "file": "PromocionarNotasCtrl.js",
  "sourceRoot": "",
  "sources": [
    "PromocionarNotasCtrl.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "'use strict'\n\nangular.module(\"myvcFrontApp\")\n\n.controller('PromocionarNotasCtrl', ['$scope', 'App', '$rootScope', '$state', '$timeout', 'uiGridConstants', 'uiGridEditConstants', '$uibModal', '$filter', 'AuthService', 'toastr', '$http', 'EscalasValorativasServ', ($scope, App, $rootScope, $state, $timeout, uiGridConstants, uiGridEditConstants, $modal, $filter, AuthService, toastr, $http, EscalasValorativasServ)->\n\n  AuthService.verificar_acceso()\n\n  #$scope.$parent.bigLoader\t\t\t= true\n  $scope.dato \t\t\t\t\t\t= {}\n  $scope.gridScope \t\t\t\t\t= $scope # Para getExternalScopes de ui-Grid\n  $scope.views \t\t\t\t\t\t= App.views\n  $scope.perfilPath \t\t  \t      \t= App.images+'perfil/'\n  $scope.hasRoleOrPerm  = AuthService.hasRoleOrPerm\n\n\n\n\n  $scope.dato.grupo = ''\n  $http.get('::grupos').then((r)->\n    matr_grupo = 0\n\n    if localStorage.matr_grupo\n      matr_grupo = parseInt(localStorage.matr_grupo)\n\n    $scope.grupos \t\t= r.data\n\n    for grupo in $scope.grupos\n      if parseInt(grupo.id) == parseInt(matr_grupo)\n        $scope.dato.grupo = grupo\n        $scope.selectGrupo($scope.dato.grupo)\n\n  )\n\n\n  EscalasValorativasServ.escalas().then((r)->\n    $scope.escalas = r\n    $scope.escala_maxima = EscalasValorativasServ.escala_maxima()\n  , (r2)->\n    console.log 'No se trajeron las escalas valorativas', r2\n  )\n\n\n\n\n  $scope.cambiaNotaComport = (nota, periodo, datos)->\n    if $scope.dato.grupo.titular_id != $scope.USER.persona_id and !$scope.hasRoleOrPerm('admin')\n      toastr.warning 'No eres el titular para cambiar comportamiento.'\n      return\n\n    if nota.id\n      temp = nota.nota\n\n      $http.put('::nota_comportamiento/update/'+nota.id, {nota: nota.nota}).then((r)->\n        toastr.success 'Nota cambiada: ' + nota.nota\n      , (r2)->\n        toastr.error 'No pudimos guardar la nota ' + nota.nota\n        nota.nota = temp\n      )\n\n    else\n      temp              = {}\n      temp.nota         = nota.nota\n      temp.year_id      = periodo.year_id\n      temp.alumno_id    = $scope[datos].alumno.id\n      temp.periodo_id   = periodo.id\n\n      $http.put('::nota_comportamiento/crear', temp).then((r)->\n        nota_temp \t= r.data.nota_comport\n        nota.id \t\t\t\t= nota_temp.id\n        nota.year_id \t\t= nota_temp.year_id\n        nota.nombres \t\t= nota_temp.nombres\n        nota.apellidos \t= nota_temp.apellidos\n        nota.alumno_id \t= nota_temp.alumno_id\n        nota.foto_id \t\t= nota_temp.foto_id\n        nota.foto_nombre \t= nota_temp.foto_nombre\n        nota.sexo \t\t\t= nota_temp.sexo\n        nota.periodo_id = nota_temp.periodo_id\n\n        toastr.success 'Nota creada: ' + nota.nota\n      , (r2)->\n        toastr.error 'No pudimos guardar la nota ' + temp.nota\n        nota = temp\n      )\n\n\n\n\n  $scope.selectGrupo = (grupo)->\n    console.log($scope.dato);\n    #$scope.dato               = {}\n    localStorage.matr_grupo   = grupo.id\n    $scope.dato.grupo \t\t    = grupo\n\n    for grup in $scope.grupos\n      grup.active = false\n\n    grupo.active = true\n\n    $http.put(\"::alumnos/de-grupo/\"+grupo.id).then((r)->\n      $scope.alumnos = r.data.alumnos\n\n      alumno_seleccionado_id = 0\n\n      if localStorage.matr_grupo\n        alumno_seleccionado_id = parseInt(localStorage.alumno_seleccionado_id)\n\n      for alum in $scope.alumnos\n        if parseInt(alum.id) == alumno_seleccionado_id\n          $scope.dato.selected_alumno = alum\n          $scope.selectAlumno($scope.dato.selected_alumno)\n\n    )\n\n  $scope.selectAlumno = (alumno)->\n    localStorage.alumno_seleccionado_id   = alumno.id\n    $scope.dato.periodo_id = undefined\n\n    $http.put(\"::alumnos/years-con-notas\", {alumno_id: alumno.id}).then((r)->\n      $scope.years_notas = r.data.years\n      $scope.years_dest = r.data.years_dest\n    )\n\n\n\n  $scope.eligirPeriodoNotas = (grupo, periodo, num_year, panel_indice, alumno)->\n\n    $scope.dato.periodo_id = periodo.id\n\n    for peri in grupo.periodos\n      if panel_indice == 1\n        peri.seleccionado_origen = false\n      else\n        peri.seleccionado_destino = false\n\n    if panel_indice == 1\n      periodo.seleccionado_origen = true\n    else\n      periodo.seleccionado_destino = true\n\n\n    $http.put(\"::notas/alumno-periodo-grupo\", {alumno_id: $scope.dato.selected_alumno.id, periodo_id: periodo.id, grupo_id: grupo.grupo_id}).then((r)->\n      if panel_indice == 1\n        $scope.datos_origen = {grupo: grupo, periodo: periodo, num_year: num_year, alumno: alumno}\n        $scope.notas_origen = r.data.notas\n      else\n        # Aquí, grupo es year en realidad con los datos del grupo\n        $scope.datos_destino = {grupo: grupo, periodo: periodo, num_year: num_year, alumno: alumno}\n        $scope.notas_destino = r.data.notas\n\n        if !$.isArray($scope.notas_destino.asignaturas)\n          $scope.notas_destino.asignaturas = [$scope.notas_destino.asignaturas[Object.keys($scope.notas_destino.asignaturas)[0]]]\n\n    )\n\n\n  $scope.pasarNota = (asignatura)->\n    if $scope.pasando_nota\n      return\n    else\n      $scope.pasando_nota = true\n\n    found = 0\n\n    for asignat in $scope.notas_destino.asignaturas\n      if asignat.materia_id == asignatura.materia_id\n        found = found + 1\n\n        if asignat.nf_id\n          $scope.asign_temp = asignatura\n\n          $http.put('::definitivas_periodos/update', {nf_id: asignat.nf_id, nota: asignatura.nota_asignatura, num_periodo: $scope.datos_destino.periodo.numero }).then((r)->\n\n            $scope.evento_definitiva_cambiada(false, asignatura)\n\n          , (r2)->\n            $scope.pasando_nota = false\n            if r2.status == 400\n              toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n            else\n              toastr.error 'No pudimos guardar la nota ' + asignatura.nota_asignatura, '', {timeOut: 8000}\n          )\n        else\n            $http.put('::definitivas_periodos/update', {alumno_id: $scope.dato.selected_alumno.id, nota: asignatura.nota_asignatura, asignatura_id: asignat.asignatura_id, num_periodo: $scope.datos_destino.periodo.numero }).then((r)->\n\n              $scope.evento_definitiva_cambiada(true, asignatura, r.data[0])\n\n            , (r2)->\n              $scope.pasando_nota = false\n              if r2.status == 400\n                toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n              else\n                toastr.error 'No pudimos guardar la nota ' + asignatura.nota_asignatura, '', {timeOut: 8000}\n            )\n\n    if found == 0\n      toastr.warning 'No coincide con ninguna materia destino.'\n      $scope.pasando_nota = false\n\n\n\n  # Para cuando sea cambiada alguna definitiva\n  $scope.evento_definitiva_cambiada = (is_new, asignatura, r)->\n    if is_new\n\n      toastr.success 'Creada: ' + asignatura.nota_asignatura\n\n      for asignatu in $scope.notas_destino.asignaturas\n        if asignatu.asignatura_id == r.asignatura_id\n          asignatu.nf_id         \t\t\t\t\t= r.id\n          asignatu.nota_asignatura        = r.nota\n          asignatu.manual \t\t\t\t\t\t\t\t= 1\n          asignatu.recuperada \t\t\t\t\t\t= 0\n          $scope.pasando_nota = false\n\n          $timeout( ()->\n            $scope.$apply()\n          )\n\n    else\n\n      for asignatu in $scope.notas_destino.asignaturas\n        if asignatu.materia_id == $scope.asign_temp.materia_id\n          asignatu.nota_asignatura   = $scope.asign_temp.nota_asignatura\n          asignatu.manual            = 1\n\n          $timeout( ()->\n            $scope.$apply()\n          )\n\n      toastr.success 'Cambiada: ' + asignatura.nota_asignatura\n      $scope.pasando_nota = false\n\n\n\n  $scope.cambiaNotaDef = (asignatura, nota, nf_id, num_periodo)->\n\n    if nota > $scope.escala_maxima.porc_final or nota == 'undefined' or nota == undefined\n      toastr.error 'No puede ser mayor de ' + $scope.escala_maxima.porc_final, 'NO guardada', {timeOut: 8000}\n      return\n\n    if nf_id\n      $http.put('::definitivas_periodos/update', {nf_id: nf_id, nota: nota}).then((r)->\n        if !asignatura.manual\n          asignatura.manual = 1\n        toastr.success 'Cambiada: ' + nota\n      , (r2)->\n        if r2.status == 400\n          toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n        else\n          toastr.error 'No pudimos guardar la nota ' + nota, '', {timeOut: 8000}\n      )\n    else\n      $http.put('::definitivas_periodos/update', {alumno_id: $scope.alumno_traido.alumno_id, nota: nota, asignatura_id: asignatura.asignatura_id, num_periodo: num_periodo }).then((r)->\n        toastr.success 'Creada: ' + nota\n        r = r.data[0]\n        asignatura.nf_id          = r.id\n        asignatura.recuperada     = 0\n        asignatura.manual         = 1\n      , (r2)->\n        if r2.status == 400\n          toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n        else\n          toastr.error 'No pudimos guardar la nota ' + nota, '', {timeOut: 8000}\n      )\n\n\n  $scope.toggleNotaFinalRecuperada = (alumno, recuperada, nf_id)->\n    $http.put('::definitivas_periodos/toggle-recuperada', {nf_id: nf_id, recuperada: recuperada}).then((r)->\n\n      if recuperada and !alumno.manual\n        alumno.manual = 1\n        toastr.success 'Indicará que es recuperada, así que también será manual.'\n      else if recuperada\n        toastr.success 'Recuperada'\n      else\n        toastr.success 'No recuperada'\n    , (r2)->\n      if r2.status == 400\n        toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n      else\n        toastr.error 'No pudimos cambiar.', '', {timeOut: 8000}\n    )\n\n  $scope.toggleNotaFinalManual = (alumno, manual, nf_id)->\n    $http.put('::definitivas_periodos/toggle-manual', {nf_id: nf_id, manual: manual}).then((r)->\n\n      if !manual and alumno.nota_final.recuperada\n        alumno.nota_final.recuperada = false\n        toastr.success 'Será automática y no recuperada.'\n      else if manual\n        toastr.success 'Nota manual.'\n      else\n        toastr.success 'Ahora la calculará el sistema.'\n    , (r2)->\n      if r2.status == 400\n        toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n      else\n        toastr.error 'No pudimos cambiar.', '', {timeOut: 8000}\n    )\n\n\n  $scope.verDetalleNota = (asignatura, alumno)->\n\n    modalInstance = $modal.open({\n      templateUrl: '==notas/notaFinalDetalleModal.tpl.html'\n      controller: 'NotaFinalDetalleModalCtrl'\n      resolve:\n        alumno: ()->\n          alumno\n        asignatura: ()->\n          asignatura\n        USER: ()->\n          $scope.USER\n        escala_maxima: ()->\n          $scope.escala_maxima\n    })\n    modalInstance.result.then( (r)->\n      if r=='Eliminada'\n        asignatura.eliminada = true\n    , ()->\n      # nada\n    )\n    return\n\n\n\n\n  return\n])\n\n\n\n\n\n\n\n\n\n\n\n\n.controller('NotaFinalDetalleModalCtrl', ['$scope', '$uibModalInstance', 'alumno', 'asignatura', 'AuthService', '$http', 'toastr', '$filter', 'USER', 'escala_maxima', ($scope, $modalInstance, alumno, asignatura, AuthService, $http, toastr, $filter, USER, escala_maxima)->\n  $scope.alumno         = alumno\n  $scope.nota           = asignatura\n  $scope.hasRoleOrPerm  = AuthService.hasRoleOrPerm\n  $scope.escala_maxima  = escala_maxima\n\n  $http.put('::historiales/nota-final-detalle', {nf_id: asignatura.nf_id}).then((r)->\n    $scope.cambios        = r.data.cambios\n    $scope.nota_detalle   = r.data.nota\n  , (r2)->\n    toastr.warning 'No se pudo traer el historial.', 'Problema'\n  )\n\n\n\n  $scope.eliminarNota = ()->\n\n      $http.delete('::definitivas_periodos/destroy/' + asignatura.nf_id).then((r)->\n        toastr.success 'Nota eliminada', 'Recarga para ver'\n        $modalInstance.close('Eliminada')\n      , (r2)->\n        toastr.error 'No se pudo eliminar nota.', 'Problema'\n      )\n\n\n  $scope.ok = ()->\n    $modalInstance.close(alumno)\n\n\n\n  $scope.cambiaNotaDef = (asignatura, nota, nf_id, num_periodo)->\n\n    if nota > $scope.escala_maxima.porc_final or nota == 'undefined' or nota == undefined\n      toastr.error 'No puede ser mayor de ' + $scope.escala_maxima.porc_final, 'NO guardada', {timeOut: 8000}\n      return\n\n    if nf_id\n      $http.put('::definitivas_periodos/update', {nf_id: nf_id, nota: nota}).then((r)->\n        if !asignatura.manual\n          asignatura.manual = 1\n        toastr.success 'Cambiada: ' + nota\n      , (r2)->\n        if r2.status == 400\n          toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n        else\n          toastr.error 'No pudimos guardar la nota ' + nota, '', {timeOut: 8000}\n      )\n    else\n      $http.put('::definitivas_periodos/update', {alumno_id: $scope.alumno_traido.alumno_id, nota: nota, asignatura_id: asignatura.asignatura_id, num_periodo: num_periodo }).then((r)->\n        toastr.success 'Creada: ' + nota\n        r = r.data[0]\n        asignatura.nf_id          = r.id\n        asignatura.recuperada     = 0\n        asignatura.manual         = 1\n      , (r2)->\n        if r2.status == 400\n          toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n        else\n          toastr.error 'No pudimos guardar la nota ' + nota, '', {timeOut: 8000}\n      )\n\n\n  $scope.toggleNotaFinalRecuperada = (alumno, recuperada, nf_id)->\n    $http.put('::definitivas_periodos/toggle-recuperada', {nf_id: nf_id, recuperada: recuperada}).then((r)->\n\n      if recuperada and !alumno.manual\n        alumno.manual = 1\n        toastr.success 'Indicará que es recuperada, así que también será manual.'\n      else if recuperada\n        toastr.success 'Recuperada'\n      else\n        toastr.success 'No recuperada'\n    , (r2)->\n      if r2.status == 400\n        toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n      else\n        toastr.error 'No pudimos cambiar.', '', {timeOut: 8000}\n    )\n\n  $scope.toggleNotaFinalManual = (alumno, manual, nf_id)->\n    $http.put('::definitivas_periodos/toggle-manual', {nf_id: nf_id, manual: manual}).then((r)->\n\n      if !manual and alumno.nota_final.recuperada\n        alumno.nota_final.recuperada = false\n        toastr.success 'Será automática y no recuperada.'\n      else if manual\n        toastr.success 'Nota manual.'\n      else\n        toastr.success 'Ahora la calculará el sistema.'\n    , (r2)->\n      if r2.status == 400\n        toastr.warning 'Parece que no tienes permisos', 'Lo sentimos'\n      else\n        toastr.error 'No pudimos cambiar.', '', {timeOut: 8000}\n    )\n\n\n\n])\n\n\n"
  ]
}