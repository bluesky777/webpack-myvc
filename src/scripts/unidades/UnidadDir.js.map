{
  "version": 3,
  "file": "UnidadDir.js",
  "sourceRoot": "",
  "sources": [
    "UnidadDir.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "angular.module('myvcFrontApp')\n\n.directive('unidadDir',['App', (App)-> \n\n\trestrict: 'E'\n\ttemplateUrl: \"#{App.views}unidades/unidadDir.tpl.html\"\n\ttransclude: true\n\tscope: \n\t\tunidad: \"=\"\n\t\tindice: \"=\"\n\n\tlink: (scope, iElem, iAttrs)->\n\t\t# Debo agregar la clase .loading-inactive para que desaparezca el loader de la pantalla.\n\t\t# y eso lo puedo hacer con el ng-if\n\n\tcontroller: ($scope, $http, toastr, $uibModal, $filter)->\n\n\t\t$scope.activar_crear_subunidad = true\n\n\n\t\t$scope.onSortSubunidades = ($item, $partFrom, $partTo, $indexFrom, $indexTo)->\n\t\t\t\n\t\t\tif $partFrom == $partTo\n\n\t\t\t\tsortHash = []\n\n\t\t\t\tfor subunidad, index in $partFrom #subunidades\n\t\t\t\t\tsubunidad.orden = index\n\n\t\t\t\t\thashEntry = {}\n\t\t\t\t\thashEntry[\"\" + subunidad.id] = index\n\t\t\t\t\tsortHash.push(hashEntry)\n\t\t\t\t\n\t\t\t\tdatos = \n\t\t\t\t\tsortHash: sortHash\n\t\t\t\t\n\t\t\t\t$http.put('::subunidades/update-orden', datos).then((r)->\n\t\t\t\t\treturn true\n\t\t\t\t, (r2)->\n\t\t\t\t\ttoastr.warning 'No se pudo ordenar', 'Problema'\n\t\t\t\t\treturn false;\n\t\t\t\t)\n\n\t\t\telse\n\n\t\t\t\tsortHash1 \t= []\n\t\t\t\tsortHash2 \t= []\n\t\t\t\tdatos \t\t= {}\n\n\t\t\t\t# Actualizamos la primera parte\n\t\t\t\tfor subunidad, index in $partFrom #subunidades\n\t\t\t\t\tsubunidad.orden = index\n\n\t\t\t\t\thashEntry = {}\n\t\t\t\t\thashEntry[\"\" + subunidad.id] = index\n\t\t\t\t\tsortHash1.push(hashEntry)\n\t\t\t\t\n\n\t\t\t\tif sortHash1.length > 0\n\t\t\t\t\tdatos.unidad1_id \t= $partFrom.unidad_id\n\t\t\t\t\tdatos.sortHash1 \t= sortHash1\n\t\t\t\t\n\t\t\t\t# Actualizamos la Segunda parte\n\t\t\t\tfor subunidad, index in $partTo \n\t\t\t\t\tsubunidad.orden = index\n\n\t\t\t\t\thashEntry = {}\n\t\t\t\t\thashEntry[\"\" + subunidad.id] = index\n\t\t\t\t\tsortHash2.push(hashEntry)\n\t\t\t\t\n\n\t\t\t\tif sortHash1.length > 0\n\t\t\t\t\tdatos.unidad2_id \t= $partTo.unidad_id\n\t\t\t\t\tdatos.sortHash2 \t= sortHash2\n\t\t\t\t\n\t\t\t\t$http.put('::subunidades/update-orden-varias', datos).then((r)->\n\t\t\t\t\treturn true\n\t\t\t\t, (r2)->\n\t\t\t\t\ttoastr.warning 'No se pudo ordenar', 'Problema'\n\t\t\t\t\treturn false;\n\t\t\t\t)\n\n\t\t\t$scope.$parent.calcularPorcUnidades()\n\t\t\t\n\n\t\t\n\n\n\n\n\t\t$scope.addSubunidad = (unidad)->\n\n\t\t\t$scope.activar_crear_subunidad = false\n\t\t\tunidad.newsubunidad.unidad_id = unidad.id\n\n\t\t\t$http.post('::subunidades', unidad.newsubunidad).then((r)->\n\t\t\t\tunidad.subunidades.push r.data\n\n\t\t\t\tcreado = 'creado'\n\t\t\t\tif $scope.$parent.GENERO_SUB == 'F'\n\t\t\t\t\tcreado = 'creada'\n\n\t\t\t\ttoastr.success $scope.$parent.SUBUNIDAD + ' ' + creado + ' con éxito.'\n\t\t\t\tunidad.newsubunidad.definicion = ''\n\t\t\t\t$scope.$parent.calcularPorcUnidades()\n\t\t\t\t$scope.activar_crear_subunidad = true\n\t\t\t, (r2)->\n\t\t\t\ttoastr.error 'No se pudo crear  ' + (if $scope.$parent.GENERO_UNI==\"M\" then 'el' else 'la') + scope.$parent.SUBUNIDAD, 'Problemas'\n\t\t\t\t$scope.activar_crear_subunidad = true\n\t\t\t)\n\n\n\t\t$scope.actualizarSubunidad = (subunidad)->\n\n\t\t\tdatos =\n\t\t\t\tdefinicion: subunidad.definicion\n\t\t\t\tporcentaje: subunidad.porcentaje\n\t\t\t\tnota_default: subunidad.nota_default\n\t\t\t\torden: subunidad.orden\n\n\t\t\t$http.put('::subunidades/update/' + subunidad.id, datos).then((r)->\n\t\t\t\t\n\t\t\t\tactualizado = 'actualizado'\n\t\t\t\tif $scope.$parent.GENERO_SUB == 'F'\n\t\t\t\t\tactualizado = 'actualizada'\n\t\t\t\t\n\t\t\t\ttoastr.success $scope.$parent.SUBUNIDAD + ' ' + actualizado + ' con éxito.'\n\t\t\t\tsubunidad.editando = false\n\n\t\t\t\t$scope.$parent.calcularPorcUnidades()\n\t\t\t, (r2)->\n\t\t\t\ttoastr.error 'No se pudo actualizar ' + $scope.$parent.SUBUNIDAD, 'Problemas'\n\t\t\t)\n\n\t\t$scope.removeSubunidad = (unidad, subunidad)->\n\n\t\t\tmodalInstance = $uibModal.open({\n\t\t\t\ttemplateUrl: '==unidades/removeSubunidad.tpl.html'\n\t\t\t\tcontroller: 'RemoveSubunidadCtrl'\n\t\t\t\tresolve: \n\t\t\t\t\tsubunidad: ()->\n\t\t\t\t\t\tsubunidad\n\t\t\t})\n\t\t\tmodalInstance.result.then( (unid)->\n\t\t\t\tunidad.subunidades = $filter('filter')(unidad.subunidades, {id: '!'+subunidad.id})\n\t\t\t\t$scope.$parent.calcularPorcUnidades()\n\t\t\t)\n\n\n\n\t\t\n\n])\n"
  ]
}