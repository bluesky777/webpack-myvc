{
  "version": 3,
  "file": "AnunciosDir.js",
  "sourceRoot": "",
  "sources": [
    "AnunciosDir.coffee"
  ],
  "names": [],
  "mappings": "AAAA;EAAA,OAAO,CAAC,MAAR,CAAe,cAAf,CAEA,CAAC,SAFD,CAEW,aAFX,EAEyB;IAAC,KAAD;IAAQ,OAAR;IAAiB,QAAjB;IAA2B,WAA3B;IAAwC,QAAxC;IAAkD,aAAlD;IAAiE,MAAjE;IAAyE,UAAzE;IAAqF,SAArF;IAAgG,QAAA,CAAC,GAAD;IAAM,KAAN;IAAa,MAAb;IAAqB,MAArB;IAA6B,MAA7B;IAAqC,WAArC;IAAkD,IAAlD;IAAwD,QAAxD;IAAkE,OAAlE,CAAA;aAEvH;QAAA,QAAA,EAAU,GAAV;QACA,WAAA,EAAa,CAAA,CAAA,CAAG,GAAG,CAAC,KAAP,CAAa,0BAAb,CADb;QAIA,IAAA,EAAM,QAAA,CAAC,KAAD;IAAQ,KAAR;IAAe,MAAf,CAAA;UAEJ,KAAK,CAAC,UAAN,GAAwB,GAAG,CAAC,MAAJ,GAAW;UACnC,KAAK,CAAC,KAAN,GAAsB,GAAG,CAAC;UAC1B,KAAK,CAAC,WAAN,GAAwB,OAAO,CAAC;UAChC,KAAK,CAAC,YAAN,GAAwB;UACxB,KAAK,CAAC,IAAN,GAAwB,CAAA;UAGxB,IAAG,MAAM,CAAC,EAAP,CAAU,OAAV,CAAH;mBACE,KAAK,CAAC,GAAN,CAAU,sBAAV;IAAkC;cAAC,MAAA,EAAQ;gBAAC,WAAA,EAAa,KAAK,CAAC;cAApB;YAAT,CAAlC,CAA8E,CAAC,IAA/E,CAAoF,QAAA,CAAC,CAAD,CAAA;AAClF,kBAAA,MAAA;IAAA,CAAA;IAAA,CAAA;IAAA,CAAA;IAAA,CAAA;IAAA,GAAA;IAAA,IAAA;IAAA,IAAA;IAAA,IAAA;IAAA,IAAA;IAAA,IAAA;IAAA,CAAA;IAAA,CAAA;IAAA,KAAA;IAAA,KAAA;IAAA,GAAA;IAAA,IAAA;IAAA,IAAA;IAAA,IAAA;IAAA,IAAA;IAAA,IAAA;IAAA,QAAA;IAAA;cAAA,KAAK,CAAC,aAAN,GAAsB,CAAC,CAAC,KAAxB;;cAGA,QAAA,CAAS,QAAA,CAAA,CAAA;AACP,oBAAA,MAAA;IAAA,CAAA;IAAA,GAAA;IAAA;AAAA;gBAAA,KAAA,qCAAA;;kBACE,MAAM,CAAC,KAAP,GAAoB,IAAI,IAAJ,CAAS,MAAM,CAAC,KAAhB;kBACpB,MAAM,CAAC,GAAP,GAAuB,MAAM,CAAC,GAAV,GAAmB,IAAI,IAAJ,CAAS,MAAM,CAAC,GAAhB,CAAnB,GAA6C;kBACjE,IAAG,MAAM,CAAC,WAAV;oBACE,MAAM,CAAC,SAAP,GAAoB,qBADtB;mBAAA,MAAA;oBAGE,MAAM,CAAC,SAAP,GAAuB,MAAM,CAAC,gBAAP,IAA2B,MAAM,CAAC,eAArC,GAA0D,oBAA1D,GAAoF,KAH1G;;gBAHF;uBAQA,KAAK,CAAC,OAAN,GAAgB,CACd,KAAK,CAAC,aAAa,CAAC,OADN;cATT,CAAT;IAaE,GAbF;cAeA,IAAG,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,MAA5B,GAAqC,CAAxC;AACE;gBAAA,KAAA,qCAAA;;kBACE,IAAG,MAAM,CAAC,SAAV;AACE;oBAAA,KAAA,wCAAA;;sBACE,QAAQ,CAAC,UAAT,GAAsB,IAAI,IAAJ,CAAS,QAAQ,CAAC,UAAU,CAAC,OAApB,CAA4B,IAA5B;IAAkC,IAAlC,CAAT;oBADxB,CADF;;gBADF,CADF;eAAA,MAAA;gBAOE,IAAG,KAAK,CAAC,aAAa,CAAC,SAAvB;AACE;kBAAA,KAAA,wCAAA;;oBACE,QAAQ,CAAC,UAAT,GAAsB,IAAI,IAAJ,CAAS,QAAQ,CAAC,UAAU,CAAC,OAApB,CAA4B,IAA5B;IAAkC,IAAlC,CAAT;kBADxB,CADF;iBAPF;;AAaA;;cAAA,KAAA,wCAAA;;gBACE,KAAK,CAAC,YAAN,GAAqB,IAAI,CAAC,WAAL,CAAiB,KAAK,CAAC,SAAvB;cADvB;cAGA,IAAG,KAAK,CAAC,aAAa,CAAC,iBAAvB;AACE;gBAAA,KAAA,wCAAA;;kBACE,KAAK,CAAC,YAAN,GAAqB,IAAI,CAAC,WAAL,CAAiB,KAAK,CAAC,SAAvB;gBADvB,CADF;;cAKA,IAAI,WAAW,CAAC,aAAZ,CAA0B,CAAC,QAAD;IAAW,WAAX,CAA1B,CAAA,IAAsD,KAAK,CAAC,IAAI,CAAC,IAAX,KAAiB,QAA3E;gBACE,KAAK,CAAC,sBAAN,GAAiC,CAAE,KAAK,CAAC,aAAa,CAAC,aAAc,CAAA,CAAA,CAApC;gBAEjC,IAAG,KAAK,CAAC,aAAa,CAAC,aAAa,CAAC,MAAlC,GAA2C,CAA9C;kBACE,KAAK,CAAC,sBAAsB,CAAC,IAA7B,CAAkC,KAAK,CAAC,aAAa,CAAC,aAAc,CAAA,CAAA,CAApE,EADF;iBAHF;;cAOA,IAAG,WAAW,CAAC,aAAZ,CAA0B,CAAC,OAAD;IAAU,UAAV,CAA1B,CAAH;gBACE,IAAG,KAAK,CAAC,aAAa,CAAC,aAAa,CAAC,MAAlC,GAA2C,CAA9C;kBACE,KAAK,CAAC,kBAAN,GAA2B,KAAK,CAAC,aAAa,CAAC,aAAc,CAAA,CAAA,EAD/D;iBADF;eA9CA;;cAqDA,IAAG,KAAK,CAAC,WAAN,GAAoB,GAAvB;gBACE,IAAG,WAAW,CAAC,aAAZ,CAA0B,CAAC,OAAD;IAAU,UAAV;IAAsB,QAAtB,CAA1B,CAAH;kBAEE,KAAK,CAAC,OAAN,GAAgB;oBACd,KAAA,EAAO;sBACL,IAAA,EAAM,kBADD;sBAEL,MAAA,EAAQ,GAFH;sBAGL,MAAA,EAAS;wBACP,GAAA,EAAK,EADE;wBAEP,KAAA,EAAO,EAFA;wBAGP,MAAA,EAAQ,EAHD;wBAIP,IAAA,EAAM;sBAJC,CAHJ;sBASL,uBAAA,EAAyB,IATpB;sBAUL,CAAA,EAAG,QAAA,CAAC,CAAD,CAAA;AAAM,+BAAO,CAAC,CAAC;sBAAf,CAVE;sBAWL,CAAA,EAAG,QAAA,CAAC,CAAD,CAAA;AAAM,+BAAO,CAAC,CAAC;sBAAf,CAXE;sBAYL,UAAA,EAAY,IAZP;sBAaL,WAAA,EAAa,QAAA,CAAC,CAAD,CAAA;+BAAM,EAAE,CAAC,MAAH,CAAU,MAAV,CAAA,CAAkB,CAAlB;sBAAN,CAbR;sBAcL,kBAAA,EAAoB,GAdf;sBAeL,KAAA,EAAO;wBACL,SAAA,EAAW,QADN;wBAEL,YAAA,EAAc,EAFT;wBAGL,UAAA,EAAY;sBAHP,CAfF;sBAoBL,IAAA,EAAM;wBACJ,OAAA,EAAS,IADL;wBAEJ,WAAA,EAAa,CAAC,CAAD;IAAG,EAAH,CAFT;wBAGJ,cAAA,EAAgB,KAHZ;wBAIJ,YAAA,EAAc,KAJV;wBAKJ,aAAA,EAAe,KALX;wBAMJ,WAAA,EAAa,IANT;wBAOJ,eAAA,EAAiB;sBAPb;oBApBD,CADO;oBA+Bd,KAAA,EAAO;sBACL,MAAA,EAAQ,KADH;sBAEL,IAAA,EAAM;oBAFD;kBA/BO;kBAsChB,OAAA,GAAU;AACV;kBAAA,KAAA,wCAAA;;oBACE,OAAO,CAAC,IAAR,CAAa;sBAAE,KAAA,EAAO,KAAK,CAAC,OAAN,GAAgB,GAAhB,GAAsB,KAAK,CAAC,SAAS,CAAC,MAAhB,CAAuB,CAAvB;IAAyB,CAAzB,CAAtB,GAAoD,GAA7D;sBAAkE,KAAA,EAAO,KAAK,CAAC;oBAA/E,CAAb;kBADF;kBAIA,KAAK,CAAC,IAAN,GAAa;oBAAC;sBACZ,GAAA,EAAK,uBADO;sBAEZ,MAAA,EAAQ;oBAFI,CAAD;oBA7Cf;iBADF;;qBAqDA,KAAK,CAAC,aAAN,GAAsB,QAAA,CAAC,MAAD,CAAA;AACpB,oBAAA,KAAA;IAAA;gBAAA,OAAO,CAAC,GAAR,CAAY,MAAZ;gBAEA,IAAG,CAAC,MAAM,CAAC,aAAX;kBACE,MAAM,CAAC,OAAP,CAAe,2BAAf;AACA,yBAFF;;gBAIA,KAAA,GAAQ;kBACN,YAAA,EAAe,MAAM,CAAC,SAAS,CAAC,YAD1B;kBAEN,SAAA,EAAc,MAAM,CAAC,SAFf;kBAGN,QAAA,EAAa,MAAM,CAAC,aAAa,CAAC,EAH5B;kBAIN,OAAA,EAAa,MAAM,CAAC,SAAS,CAAC,OAJxB;kBAKN,MAAA,EAAY;gBALN;gBAQR,aAAA,GAAgB,MAAM,CAAC,IAAP,CAAY;kBAC1B,WAAA,EAAa,gDADa;kBAE1B,UAAA,EAAY,4BAFc;kBAG1B,OAAA,EACE;oBAAA,KAAA,EAAO,QAAA,CAAA,CAAA;6BACL;oBADK,CAAP;oBAEA,MAAA,EAAQ,QAAA,CAAA,CAAA;6BACN;oBADM,CAFR;oBAIA,IAAA,EAAM,QAAA,CAAA,CAAA;6BACJ,KAAK,CAAC;oBADF;kBAJN;gBAJwB,CAAZ;uBAWhB,aAAa,CAAC,MAAM,CAAC,IAArB,CAA2B,QAAA,CAAC,IAAD,CAAA;yBACzB,OAAO,CAAC,GAAR,CAAY,gBAAZ;gBADyB,CAA3B;cA1BoB;YA3G4D,CAApF;IA4IE,QAAA,CAAC,EAAD,CAAA,EAAA;;qBAEA,OAAO,CAAC,GAAR,CAAY,EAAZ;YAFA,CA5IF,EADF;;QATI,CAJN;QA+JA,UAAA,EAAY;MA/JZ;IAFuH,CAAhG;GAFzB,CAuKA,CAAC,SAvKD,CAuKW,uBAvKX,EAuKmC;IAAC,KAAD;IAAQ,QAAA,CAAC,GAAD,CAAA;aAEzC;QAAA,QAAA,EAAU,GAAV;QACA,WAAA,EAAa,CAAA,CAAA,CAAG,GAAG,CAAC,KAAP,CAAa,oCAAb;MADb;IAFyC,CAAR;GAvKnC,CA+KA,CAAC,SA/KD,CA+KW,oBA/KX,EA+KgC;IAAC,KAAD;IAAQ,QAAA,CAAC,GAAD,CAAA;aAEtC;QAAA,QAAA,EAAU,GAAV;QACA,WAAA,EAAa,CAAA,CAAA,CAAG,GAAG,CAAC,KAAP,CAAa,iCAAb;MADb;IAFsC,CAAR;GA/KhC,CA6LA,CAAC,UA7LD,CA6LY,4BA7LZ,EA6L0C;IAAC,QAAD;IAAW,mBAAX;IAAgC,OAAhC;IAAyC,QAAzC;IAAmD,MAAnD;IAA2D,OAA3D;IAAoE,QAApE;IAA8E,KAA9E;IAAqF,QAAA,CAAC,MAAD;IAAS,cAAT;IAAyB,KAAzB;IAAgC,MAAhC;IAAwC,IAAxC;IAA8C,KAA9C;IAAqD,MAArD;IAA6D,GAA7D,CAAA;MAE7H,MAAM,CAAC,UAAP,GAAoB,GAAG,CAAC,MAAJ,GAAa;MACjC,MAAM,CAAC,IAAP,GAAoB;MACpB,MAAM,CAAC,MAAP,GAAoB;MAEpB,MAAM,CAAC,EAAP,GAAY,QAAA,CAAA,CAAA;QAEV,IAAG,MAAM,CAAC,eAAV;AACE,iBADF;;QAGA,MAAM,CAAC,eAAP,GAAyB;eAEzB,KAAK,CAAC,GAAN,CAAU,4BAAV;IAAwC,KAAxC,CAA8C,CAAC,IAA/C,CAAoD,QAAA,CAAC,CAAD,CAAA;UAClD,MAAM,CAAC,OAAP,CAAe,uBAAf;UACA,MAAM,CAAC,eAAP,GAA4B;UAC5B,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,cAAjB,GAAkC,IAAI,IAAJ,CAAS,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,cAAc,CAAC,OAAhC,CAAwC,IAAxC;IAA8C,IAA9C,CAAT;UAClC,MAAM,CAAC,MAAM,CAAC,SAAd,GAA4B,CAAC,CAAC,IAAI,CAAC;iBAEnC,cAAc,CAAC,KAAf,CAAqB,CAAC,CAAC,IAAvB;QANkD,CAApD;IAOE,QAAA,CAAC,EAAD,CAAA;UACA,MAAM,CAAC,KAAP,CAAa,uBAAA,GAA0B,CAAC,MAAM,CAAC,IAAI,CAAC,IAAZ,GAAiB,CAAlB,CAAvC;IAA6D,UAA7D;iBACA,MAAM,CAAC,eAAP,GAAyB;QAFzB,CAPF;MAPU;aAqBZ,MAAM,CAAC,MAAP,GAAgB,QAAA,CAAA,CAAA;eACd,cAAc,CAAC,OAAf,CAAuB,QAAvB;MADc;IA3B6G,CAArF;GA7L1C,CAgOA,CAAC,UAhOD,CAgOY,kBAhOZ,EAgOgC;IAAC,QAAD;IAAW,mBAAX;IAAgC,OAAhC;IAAyC,MAAzC;IAAiD,aAAjD;IAAgE,OAAhE;IAAyE,QAAzE;IAAmF,KAAnF;IAA0F,QAAA,CAAC,MAAD;IAAS,cAAT;IAAyB,KAAzB;IAAgC,IAAhC;IAAsC,WAAtC;IAAmD,KAAnD;IAA0D,MAA1D;IAAkE,GAAlE,CAAA;MAExH,MAAM,CAAC,UAAP,GAAoB,GAAG,CAAC,MAAJ,GAAa;MACjC,MAAM,CAAC,KAAP,GAAe;MAGf,MAAM,CAAC,iBAAP,GAA2B,QAAA,CAAA,CAAA;AACvB,YAAA;QAAA,KAAA,GAAQ;UAAE,MAAA,EAAQ,KAAV;UAAiB,IAAA,EAAM,IAAvB;UAA6B,QAAA,EAAU,KAAK,CAAC;QAA7C;eAER,KAAK,CAAC,GAAN,CAAU,mCAAV;IAA+C,KAA/C,CAAqD,CAAC,IAAtD,CAA2D,QAAA,CAAC,CAAD,CAAA;iBACzD,cAAc,CAAC,KAAf,CAAqB,CAAC,CAAC,IAAvB;QADyD,CAA3D;IAEE,QAAA,CAAC,EAAD,CAAA;iBACA,MAAM,CAAC,OAAP,CAAe,UAAf;IAA2B,8BAA3B;QADA,CAFF;MAHuB;MAU3B,MAAM,CAAC,EAAP,GAAY,QAAA,CAAA,CAAA;AACV,YAAA;QAAA,IAAG,KAAK,CAAC,aAAT;iBACE,MAAM,CAAC,iBAAP,CAAA,EADF;SAAA,MAAA;UAGE,KAAA,GAAQ;YAAE,QAAA,EAAU,KAAK,CAAC,QAAlB;YAA4B,OAAA,EAAS,KAAK,CAAC,QAAQ,CAAC,OAApD;YAA6D,IAAA,EAAM,IAAnE;YAAyE,WAAA,EAAa,WAAtF;YAAmG,QAAA,EAAU,KAAK,CAAC;UAAnH;UAER,IAAG,KAAK,CAAC,SAAT;YACE,KAAK,CAAC,SAAN,GAAkB,KAAK,CAAC,UAD1B;;iBAGA,KAAK,CAAC,GAAN,CAAU,+BAAV;IAA2C,KAA3C,CAAiD,CAAC,IAAlD,CAAuD,QAAA,CAAC,CAAD,CAAA;mBACrD,cAAc,CAAC,KAAf,CAAqB,CAAC,CAAC,IAAvB;UADqD,CAAvD;IAEE,QAAA,CAAC,EAAD,CAAA;mBACA,MAAM,CAAC,OAAP,CAAe,UAAf;IAA2B,8BAA3B;UADA,CAFF,EARF;;MADU;aAiBZ,MAAM,CAAC,MAAP,GAAgB,QAAA,CAAA,CAAA;eACd,cAAc,CAAC,OAAf,CAAuB,QAAvB;MADc;IAjCwG,CAA1F;GAhOhC,CA0QA,CAAC,UA1QD,CA0QY,mBA1QZ,EA0QiC;IAAC,QAAD;IAAW,mBAAX;IAAgC,OAAhC;IAAyC,MAAzC;IAAiD,OAAjD;IAA0D,QAA1D;IAAoE,KAApE;IAA2E,QAAA,CAAC,MAAD;IAAS,cAAT;IAAyB,KAAzB;IAAgC,IAAhC;IAAsC,KAAtC;IAA6C,MAA7C;IAAqD,GAArD,CAAA;MAE1G,MAAM,CAAC,UAAP,GAAoB,GAAG,CAAC,MAAJ,GAAa;MACjC,MAAM,CAAC,KAAP,GAAe;MAEf,MAAM,CAAC,EAAP,GAAY,QAAA,CAAA,CAAA;AAEV,YAAA,aAAA;IAAA,OAAA;IAAA;QAAA,OAAA,GAAmB,KAAK,CAAC,QAAT,GAAuB,KAAK,CAAC,QAAQ,CAAC,OAAtC,GAAmD,KAAK,CAAC;QACzE,aAAA,GAAgB,KAAK,CAAC,QAAQ,CAAC;QAE/B,KAAA,GAAQ;UAAE,QAAA,EAAU,KAAK,CAAC,QAAlB;UAA4B,OAAA,EAAS,OAArC;UAA8C,aAAA,EAAe,aAA7D;UAA4E,IAAA,EAAM,IAAlF;UAAwF,QAAA,EAAU,KAAK,CAAC;QAAxG;eAER,KAAK,CAAC,GAAN,CAAU,yBAAV;IAAqC,KAArC,CAA2C,CAAC,IAA5C,CAAiD,QAAA,CAAC,CAAD,CAAA;iBAC/C,cAAc,CAAC,KAAf,CAAqB,CAAC,CAAC,IAAvB;QAD+C,CAAjD;IAEE,QAAA,CAAC,EAAD,CAAA;iBACA,MAAM,CAAC,KAAP,CAAa,UAAb;IAAyB,+BAAzB;QADA,CAFF;MAPU;aAcZ,MAAM,CAAC,MAAP,GAAgB,QAAA,CAAA,CAAA;eACd,cAAc,CAAC,OAAf,CAAuB,QAAvB;MADc;IAnB0F,CAA3E;GA1QjC,CAmSA,CAAC,UAnSD,CAmSY,mBAnSZ,EAmSiC;IAAC,QAAD;IAAW,mBAAX;IAAgC,OAAhC;IAAyC,OAAzC;IAAkD,QAAlD;IAA4D,KAA5D;IAAmE,QAAA,CAAC,MAAD;IAAS,cAAT;IAAyB,KAAzB;IAAgC,KAAhC;IAAuC,MAAvC;IAA+C,GAA/C,CAAA;MAClG,MAAM,CAAC,UAAP,GAAoB,GAAG,CAAC,MAAJ,GAAa;MACjC,MAAM,CAAC,KAAP,GAAe;MAEf,MAAM,CAAC,EAAP,GAAY,QAAA,CAAA,CAAA;AAEV,YAAA;QAAA,KAAA,GAAQ;UAAE,QAAA,EAAU,KAAK,CAAC,QAAlB;UAA4B,OAAA,EAAS,KAAK,CAAC,QAAQ,CAAC;QAApD;eAER,KAAK,CAAC,GAAN,CAAU,yBAAV;IAAqC,KAArC,CAA2C,CAAC,IAA5C,CAAiD,QAAA,CAAC,CAAD,CAAA;iBAC/C,cAAc,CAAC,KAAf,CAAqB,CAAC,CAAC,IAAvB;QAD+C,CAAjD;IAEE,QAAA,CAAC,EAAD,CAAA;iBACA,MAAM,CAAC,KAAP,CAAa,UAAb;IAAyB,iCAAzB;QADA,CAFF;MAJU;aAWZ,MAAM,CAAC,MAAP,GAAgB,QAAA,CAAA,CAAA;eACd,cAAc,CAAC,OAAf,CAAuB,QAAvB;MADc;IAfkF,CAAnE;GAnSjC;AAAA",
  "sourcesContent": [
    "angular.module('myvcFrontApp')\n\n.directive('anunciosDir',['App', '$http', 'toastr', '$uibModal', '$state', 'AuthService', '$sce', '$timeout', '$window', (App, $http, toastr, $modal, $state, AuthService, $sce, $timeout, $window)->\n\n  restrict: 'E'\n  templateUrl: \"#{App.views}panel/anunciosDir.tpl.html\"\n\n\n  link: (scope, iElem, iAttrs)->\n\n    scope.perfilPath      = App.images+'perfil/'\n    scope.views \t\t      = App.views\n    scope.anchoWindow     = $window.innerWidth\n    scope.mostrandoHoy    = true\n    scope.dato            = {}\n\n\n    if $state.is 'panel'\n      $http.get('::ChangesAsked/to-me', {params: {anchoWindow: scope.anchoWindow }}).then((r)->\n        scope.changes_asked = r.data\n\n        # Calendario\n        $timeout(()->\n          for evento in scope.changes_asked.eventos\n            evento.start      = new Date(evento.start);\n            evento.end        = if evento.end then new Date(evento.end) else null;\n            if evento.solo_profes\n              evento.className  = 'evento-solo-profes'\n            else\n              evento.className  = if evento.cumple_alumno_id or evento.cumple_profe_id then 'evento-cumpleanios' else null\n\n          scope.eventos = [\n            scope.changes_asked.eventos\n          ];\n\n        , 500)\n\n        if scope.changes_asked.alumnos.length > 0\n          for alumno in scope.changes_asked.alumnos\n            if alumno.uniformes\n              for uniforme in alumno.uniformes\n                uniforme.fecha_hora = new Date(uniforme.fecha_hora.replace(/-/g, '\\/'))\n  \n        else\n          if scope.changes_asked.uniformes\n            for uniforme in scope.changes_asked.uniformes\n              uniforme.fecha_hora = new Date(uniforme.fecha_hora.replace(/-/g, '\\/'))\n\n\n        # Publicaciones\n        for publi in scope.changes_asked.publicaciones\n          publi.contenido_tr = $sce.trustAsHtml(publi.contenido)\n\n        if scope.changes_asked.mis_publicaciones\n          for publi in scope.changes_asked.mis_publicaciones\n            publi.contenido_tr = $sce.trustAsHtml(publi.contenido)\n\n\n        if (AuthService.hasRoleOrPerm(['alumno', 'acudiente']) || scope.USER.tipo=='Alumno')\n          scope.publicaciones_actuales   = [ scope.changes_asked.publicaciones[0] ]\n\n          if scope.changes_asked.publicaciones.length > 1\n            scope.publicaciones_actuales.push(scope.changes_asked.publicaciones[1])\n\n\n        if AuthService.hasRoleOrPerm(['admin', 'profesor'])\n          if scope.changes_asked.publicaciones.length > 0\n            scope.publicacion_actual = scope.changes_asked.publicaciones[0]\n\n\n\n        # Gráfico del trabajo de profesores\n        if scope.anchoWindow > 500\n          if AuthService.hasRoleOrPerm(['admin', 'profesor', 'alumno'])\n\n            scope.options = {\n              chart: {\n                type: 'discreteBarChart',\n                height: 180,\n                margin : {\n                  top: 20,\n                  right: 20,\n                  bottom: 60,\n                  left: 55\n                },\n                useInteractiveGuideline: true,\n                x: (d)-> return d.label;\n                y: (d)-> return d.value;\n                showValues: true,\n                valueFormat: (d)-> d3.format(',.0f')(d);\n                transitionDuration: 500\n                xAxis: {\n                  axisLabel: \"X Axis\",\n                  rotateLabels: 30,\n                  showMaxMin: false\n                }\n                zoom: {\n                  enabled: true,\n                  scaleExtent: [1,10],\n                  useFixedDomain: false,\n                  useNiceScale: false,\n                  horizontalOff: false,\n                  verticalOff: true,\n                  unzoomEventType: \"dblclick.zoom\"\n                }\n              }\n              title: {\n                enable: false,\n                text: 'Asignaturas correctas'\n              }\n            };\n\n\n            valores = []\n            for profe in scope.changes_asked.profes_actuales\n              valores.push { label: profe.nombres + ' ' + profe.apellidos.substr(0,1) + '.', value: profe.porcentaje }\n\n\n            scope.data = [{\n              key: \"Asignaturas correctas\",\n              values: valores\n            }];\n        # fin de IF AuthService\n\n\n        scope.prematricular = (alumno)->\n          console.log(alumno)\n\n          if !alumno.grupo_prematr\n            toastr.warning 'Debe seleccionar el grupo'\n            return\n\n          datos = {\n            matricula_id: \talumno.next_year.matricula_id,\n            alumno_id: \t\t\talumno.alumno_id,\n            grupo_id: \t\t\talumno.grupo_prematr.id,\n            year_id: \t\t\t\talumno.next_year.year_id,\n            estado: \t\t\t\t'PREA'\n          }\n\n          modalInstance = $modal.open({\n            templateUrl: '==alumnos/prematricularConfirmarModal.tpl.html'\n            controller: 'PrematricularConfirmarCtrl'\n            resolve:\n              datos: ()->\n                datos\n              alumno: ()->\n                alumno\n              USER: ()->\n                scope.USER\n          })\n          modalInstance.result.then( (alum)->\n            console.log('Prematriculado');\n          )\n\n\n\n\n      , (r2)->\n        #toastr.error 'No se pudo traer los anuncios.'\n        console.log r2\n      )\n\n  controller: 'AnunciosDirCtrl'\n])\n\n\n.directive('publicacionesPanelDir',['App', (App)->\n\n  restrict: 'E'\n  templateUrl: \"#{App.views}panel/publicacionesPanelDir.tpl.html\"\n\n])\n\n\n.directive('horarioHoyPanelDir',['App', (App)->\n\n  restrict: 'E'\n  templateUrl: \"#{App.views}panel/horarioHoyPanelDir.tpl.html\"\n\n])\n\n\n\n\n\n\n\n\n.controller('PrematricularConfirmarCtrl', ['$scope', '$uibModalInstance', 'datos', 'alumno', 'USER', '$http', 'toastr', 'App', ($scope, $modalInstance, datos, alumno, USER, $http, toastr, App)->\n\n  $scope.imagesPath = App.images + 'perfil/'\n  $scope.USER       = USER\n  $scope.alumno     = alumno\n\n  $scope.ok = ()->\n\n    if $scope.prematriculando\n      return\n\n    $scope.prematriculando = true\n\n    $http.put('::matriculas/prematricular', datos).then((r)->\n      toastr.success 'Alumno prematriculado'\n      $scope.prematriculando    = false\n      r.data.matricula.prematriculado = new Date(r.data.matricula.prematriculado.replace(/-/g, '\\/'))\n      $scope.alumno.next_year   = r.data.matricula\n\n      $modalInstance.close(r.data)\n    , (r2)->\n      toastr.error 'Tal vez no existe el ' + ($scope.USER.year+1), 'Problema'\n      $scope.prematriculando = false\n    )\n\n\n\n  $scope.cancel = ()->\n    $modalInstance.dismiss('cancel')\n\n])\n\n\n\n\n.controller('AceptarAskedCtrl', ['$scope', '$uibModalInstance', 'asked', 'tipo', 'valor_nuevo', '$http', 'toastr', 'App', ($scope, $modalInstance, asked, tipo, valor_nuevo, $http, toastr, App)->\n\n  $scope.imagesPath = App.images + 'perfil/'\n  $scope.asked = asked\n\n\n  $scope.aceptarAsignatura = ()->\n      datos = { pedido: asked, tipo: tipo, asker_id: asked.asked_by_user_id }\n\n      $http.put('::ChangesAsked/aceptar-asignatura', datos).then((r)->\n        $modalInstance.close(r.data)\n      , (r2)->\n        toastr.warning 'Problema', 'No se pudo aceptar petición.'\n      )\n\n\n  $scope.ok = ()->\n    if asked.assignment_id\n      $scope.aceptarAsignatura()\n    else\n      datos = { asked_id: asked.asked_id, data_id: asked.detalles.data_id, tipo: tipo, valor_nuevo: valor_nuevo, asker_id: asked.asked_by_user_id }\n\n      if asked.alumno_id\n        datos.alumno_id = asked.alumno_id\n\n      $http.put('::ChangesAsked/aceptar-alumno', datos).then((r)->\n        $modalInstance.close(r.data)\n      , (r2)->\n        toastr.warning 'Problema', 'No se pudo aceptar petición.'\n      )\n\n\n\n  $scope.cancel = ()->\n    $modalInstance.dismiss('cancel')\n\n\n])\n\n\n\n\n.controller('RechazarAskedCtrl', ['$scope', '$uibModalInstance', 'asked', 'tipo', '$http', 'toastr', 'App', ($scope, $modalInstance, asked, tipo, $http, toastr, App)->\n\n  $scope.imagesPath = App.images + 'perfil/'\n  $scope.asked = asked\n\n  $scope.ok = ()->\n\n    data_id       = if asked.detalles then asked.detalles.data_id else asked.assignment_id\n    assignment_id = asked.detalles.assignment_id\n\n    datos = { asked_id: asked.asked_id, data_id: data_id, assignment_id: assignment_id, tipo: tipo, asker_id: asked.asked_by_user_id }\n\n    $http.put('::ChangesAsked/rechazar', datos).then((r)->\n      $modalInstance.close(r.data)\n    , (r2)->\n      toastr.error 'Problema', 'No se pudo rechazar petición.'\n    )\n\n\n  $scope.cancel = ()->\n    $modalInstance.dismiss('cancel')\n\n])\n\n\n.controller('EliminarAskedCtrl', ['$scope', '$uibModalInstance', 'asked', '$http', 'toastr', 'App', ($scope, $modalInstance, asked, $http, toastr, App)->\n  $scope.imagesPath = App.images + 'perfil/'\n  $scope.asked = asked\n\n  $scope.ok = ()->\n\n    datos = { asked_id: asked.asked_id, data_id: asked.detalles.data_id }\n\n    $http.put('::ChangesAsked/destruir', datos).then((r)->\n      $modalInstance.close(r.data)\n    , (r2)->\n      toastr.error 'Problema', 'No se pudo eliminar peticiones.'\n    )\n\n\n  $scope.cancel = ()->\n    $modalInstance.dismiss('cancel')\n\n])\n\n\n"
  ]
}