{
  "version": 3,
  "file": "GruposCtrl.js",
  "sourceRoot": "",
  "sources": [
    "GruposCtrl.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "'use strict'\n\nangular.module('myvcFrontApp')\n.controller('GruposCtrl', ['$scope', '$filter', '$state', 'grados', 'profesores', '$uibModal', '$http', 'toastr', 'AuthService', ($scope, $filter, $state, grados, profesores, $modal, $http, toastr, AuthService) ->\n\n\t$scope.gridScope = $scope # Para getExternalScopes de ui-Grid\n\n\t$scope.grados = grados\n\t$scope.profesores = profesores\n\n\t$scope.hasRoleOrPerm = AuthService.hasRoleOrPerm\n\n\t$scope.editar = (row)->\n\t\t$state.go('panel.grupos.editar', {grupo_id: row.id})\n\n\t$scope.eliminar = (row)->\n\n\t\tmodalInstance = $modal.open({\n\t\t\ttemplateUrl: '==grados/removeGrupo.tpl.html'\n\t\t\tcontroller: 'RemoveGrupoCtrl'\n\t\t\tresolve:\n\t\t\t\tgrupo: ()->\n\t\t\t\t\trow\n\t\t})\n\t\tmodalInstance.result.then( (grupo)->\n\t\t\t$scope.grupos = $filter('filter')($scope.grupos, {id: '!'+grupo.id})\n\t\t\t$scope.gridOptions.data = $scope.grupos\n\t\t)\n\n\t# ng-true-value=\"\\'1\\'\" ng-false-value=\"\\'0\\'\"\n\tbtGrid1 = '<a uib-tooltip=\"Editar\" tooltip-placement=\"left\" class=\"btn btn-default btn-xs shiny icon-only info\" ng-click=\"grid.appScope.editar(row.entity)\"><i class=\"fa fa-edit \"></i></a>'\n\tbtGrid2 = '<a uib-tooltip=\"X Eliminar\" tooltip-placement=\"right\" class=\"btn btn-default btn-xs shiny icon-only danger\" ng-click=\"grid.appScope.eliminar(row.entity)\"><i class=\"fa fa-trash \"></i></a>'\n\tbtGrid3 = '<a uib-tooltip=\"Listado de alumnos\" tooltip-placement=\"right\" class=\"btn btn-default btn-xs shiny icon-only info\" ui-sref=\"panel.listalumnos({grupo_id: row.entity.id})\"><i class=\"fa fa-users \"></i></a>'\n\tbtCarit = \"==grados/botonCaritasGrupo.tpl.html\"\n\n\t$scope.gridOptions =\n\t\tshowGridFooter: true,\n\t\tenableSorting: true,\n\t\tenableFiltering: true,\n\t\tenebleGridColumnMenu: false,\n\t\tenableCellEditOnFocus: true,\n\t\tcolumnDefs: [\n\t\t\t{ field: 'orden', type: 'number', width: 40 }\n\t\t\t{ name: 'edicion', displayName:'Edición', width: 80, enableSorting: false, enableFiltering: false, cellTemplate: btGrid1 + btGrid2 + btGrid3, enableCellEdit: false}\n\t\t\t{ field: 'nombre', enableHiding: false, minWidth: 100 }\n\t\t\t{ field: 'abrev', displayName:'Abrev', minWidth: 30 }\n\t\t\t{ field: 'titular_id', displayName: 'Titular', minWidth: 130, editDropdownOptionsArray: profesores, cellFilter: 'mapProfesores:grid.appScope.profesores', editableCellTemplate: 'ui-grid/dropdownEditor', editDropdownIdLabel: 'profesor_id', editDropdownValueLabel: 'nombre_completo' }\n\t\t\t{ field: 'grado_id', displayName: 'Grado', minWidth: 90, editDropdownOptionsArray: grados, cellFilter: 'mapGrado:grid.appScope.grados', editableCellTemplate: 'ui-grid/dropdownEditor', editDropdownIdLabel: 'id', editDropdownValueLabel: 'nombre' }\n\t\t\t{ field: 'cant_alumnos', displayName: 'Canti alumnos', enableSorting: false, enableCellEdit: false }\n\t\t\t{ field: 'cupo', displayName: 'Cupo', minWidth: 40, type: 'number' }\n\t\t],\n\t\tmultiSelect: false,\n\t\t#filterOptions: $scope.filterOptions,\n\t\tonRegisterApi: ( gridApi ) ->\n\t\t\t$scope.gridApi = gridApi\n\t\t\tgridApi.edit.on.afterCellEdit($scope, (rowEntity, colDef, newValue, oldValue)->\n\n\t\t\t\tif newValue != oldValue\n\t\t\t\t\tdato =\n\t\t\t\t\t\tabrev:\t  \trowEntity.abrev\n\t\t\t\t\t\tgrado_id: \trowEntity.grado_id\n\t\t\t\t\t\tnombre:\t\t  rowEntity.nombre\n\t\t\t\t\t\torden:\t  \trowEntity.orden\n\t\t\t\t\t\ttitular_id:\trowEntity.titular_id\n\t\t\t\t\t\tcaritas:\t  rowEntity.caritas\n\t\t\t\t\t\tcupo:\t      rowEntity.cupo\n\t\t\t\t\t\tid:\t\t\t    rowEntity.id\n\n\t\t\t\t\t$http.put('::grupos/update', dato).then((r)->\n\t\t\t\t\t\ttoastr.success 'Grupo actualizado con éxito', 'Actualizado'\n\t\t\t\t\t, (r2)->\n\t\t\t\t\t\ttoastr.error 'Cambio no guardado', 'Error'\n\t\t\t\t\t)\n\t\t\t\t$scope.$apply()\n\t\t\t)\n\n\n\t$scope.cambiarCaritas = (rowEntity)->\n\t\trowEntity.caritas = !rowEntity.caritas\n\t\tdato =\n\t\t\tabrev:\t  \trowEntity.abrev\n\t\t\tgrado_id: \trowEntity.grado_id\n\t\t\tnombre:\t\t  rowEntity.nombre\n\t\t\torden:\t  \trowEntity.orden\n\t\t\ttitular_id:\trowEntity.titular_id\n\t\t\tcaritas:\t  rowEntity.caritas\n\t\t\tid:\t\t\t    rowEntity.id\n\n\t\t$http.put('::grupos/update', dato).then((r)->\n\t\t\ttoastr.success 'Grupo actualizado con éxito', 'Actualizado'\n\t\t, (r2)->\n\t\t\ttoastr.error 'Cambio no guardado', 'Error'\n\t\t)\n\n\n\t$http.get('::grupos/cant-alumnos').then((data)->\n\t\t$scope.grupos = data.data\n\t\tfor grup in $scope.grupos\n\t\t\tgrup.caritas = if grup.caritas then true else false\n\t\t$scope.gridOptions.data = $scope.grupos;\n\t)\n\n\t$scope.$on 'grupocreado', (ev, grupo)->\n\t\t$scope.grupos.push grupo\n\t\t$scope.gridOptions.data = $scope.grupos;\n\n\treturn\n])\n\n.filter('mapGrado', ['$filter', ($filter)->\n\n\treturn (input, grados)->\n\t\tif not input\n\t\t\treturn 'Elija...'\n\t\telse\n\t\t\tgrad = $filter('filter')(grados, {id: input})[0]\n\t\t\treturn  grad.nombre\n])\n\n\n\n.controller('RemoveGrupoCtrl', ['$scope', '$uibModalInstance', 'grupo', '$http', 'toastr', ($scope, $modalInstance, grupo, $http, toastr)->\n\t$scope.grupo = grupo\n\n\t$scope.ok = ()->\n\n\t\t$http.delete('::grupos/destroy/'+grupo.id).then((r)->\n\t\t\ttoastr.success 'Grupo '+grupo.nombre+' eliminado con éxito.', 'Eliminado'\n\t\t, (r2)->\n\t\t\ttoastr.warning 'No se pudo eliminar al grupo.', 'Problema'\n\t\t)\n\t\t$modalInstance.close(grupo)\n\n\t$scope.cancel = ()->\n\t\t$modalInstance.dismiss('cancel')\n\n])\n"
  ]
}